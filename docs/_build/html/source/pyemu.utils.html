
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyemu.utils package &#8212; pyEMU 0.3 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="pyemu-utils-package">
<h1>pyemu.utils package<a class="headerlink" href="#pyemu-utils-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyemu.utils.geostats">
<span id="pyemu-utils-geostats-module"></span><h2>pyemu.utils.geostats module<a class="headerlink" href="#module-pyemu.utils.geostats" title="Permalink to this headline">¶</a></h2>
<p>Geostatistical analyses within the pyemu framework.
Support for Ordinary Kriging as well as construction of
covariance matrices from (nested) geostistical structures.
Also support for reading GSLIB and SGEMS files</p>
<dl class="class">
<dt id="pyemu.utils.geostats.GeoStruct">
<em class="property">class </em><code class="descclassname">pyemu.utils.geostats.</code><code class="descname">GeoStruct</code><span class="sig-paren">(</span><em>nugget=0.0</em>, <em>variograms=[]</em>, <em>name='struct1'</em>, <em>transform='none'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GeoStruct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>a geostatistical structure object.  The object contains
variograms and (optionally) nugget information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nugget</strong> (<em>(</em><em>float</em><em>)</em>) – nugget contribution</li>
<li><strong>variograms</strong> (<em>(</em><em>list</em><em> or </em><em>Vario2d instance</em><em>)</em>) – variogram(s) associated with this GeoStruct instance</li>
<li><strong>name</strong> (<em>(</em><em>str</em><em>)</em>) – name to assign the structure.  Default is “struct1”.</li>
<li><strong>transform</strong> (<em>(</em><em>str</em><em>)</em>) – the transformation to apply to the GeoStruct.  Can be
“none” or “log”, depending on the transformation of the
property being represented by the GeoStruct.
Default is “none</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pyemu.utils.geostats.GeoStruct.variograms">
<code class="descname">variograms</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.variograms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> – the Vario2d objects associated with the GeoStruct</p>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.utils.geostats.GeoStruct.name">
<code class="descname">name</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – the name of the GeoStruct</p>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.utils.geostats.GeoStruct.transform">
<code class="descname">transform</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.transform" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – the transform of the GeoStruct</p>
</dd></dl>

<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;v</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.ExpVario(a=1000,contribution=1.0)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;gs</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.GeoStruct(variograms=v,nugget=0.5)</span></code></p>
</div>
<dl class="method">
<dt id="pyemu.utils.geostats.GeoStruct.to_struct_file">
<code class="descname">to_struct_file</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GeoStruct.to_struct_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.to_struct_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a PEST-style structure file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> (<em>(</em><em>str</em><em> or </em><em>file handle</em><em>)</em>) – file to write the GeoStruct information to</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.GeoStruct.sparse_covariance_matrix">
<code class="descname">sparse_covariance_matrix</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>names</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GeoStruct.sparse_covariance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.sparse_covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>build a pyemu.Cov instance from GeoStruct</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – x-coordinate locations</li>
<li><strong>y</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – y-coordinate locations</li>
<li><strong>names</strong> (<em>(</em><em>iterable of str</em><em>)</em>) – (parameter) names of locations.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>sparse</strong> – the sparse covariance matrix implied by this GeoStruct for the x,y pairs.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.SparseMatrix</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pp_df</span> <span class="pre">=</span> <span class="pre">pyemu.pp_utils.pp_file_to_dataframe(&quot;hkpp.dat&quot;)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;cov</span> <span class="pre">=</span> <span class="pre">gs.covariance_matrix(pp_df.x,pp_df.y,pp_df.name)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.GeoStruct.covariance_matrix">
<code class="descname">covariance_matrix</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>names=None</em>, <em>cov=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GeoStruct.covariance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>build a pyemu.Cov instance from GeoStruct</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – x-coordinate locations</li>
<li><strong>y</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – y-coordinate locations</li>
<li><strong>names</strong> (<em>(</em><em>iterable of str</em><em>)</em>) – names of location. If None, cov must not be None.  Default is None.</li>
<li><strong>cov</strong> (<em>(</em><em>pyemu.Cov</em><em>) </em><em>instance</em>) – an existing Cov instance.  The contribution of this GeoStruct is added
to cov.  If cov is None, names must not be None. Default is None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cov</strong> – the covariance matrix implied by this GeoStruct for the x,y pairs.
cov has row and column names supplied by the names argument unless
the “cov” argument was passed.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.Cov</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">either “names” or “cov” must be passed.  If “cov” is passed, cov.shape
must equal len(x) and len(y).</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pp_df</span> <span class="pre">=</span> <span class="pre">pyemu.pp_utils.pp_file_to_dataframe(&quot;hkpp.dat&quot;)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;cov</span> <span class="pre">=</span> <span class="pre">gs.covariance_matrix(pp_df.x,pp_df.y,pp_df.name)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.GeoStruct.covariance">
<code class="descname">covariance</code><span class="sig-paren">(</span><em>pt0</em>, <em>pt1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GeoStruct.covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>get the covariance between two points implied by the GeoStruct.
This is used during the ordinary kriging process to get the RHS</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pt0</strong> (<em>(</em><em>iterable length 2 of floats</em><em>)</em>) – </li>
<li><strong>pt1</strong> (<em>(</em><em>iterable length 2 of floats</em><em>)</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>covariance</strong> – the covariance between pt0 and pt1 implied by the GeoStruct</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.GeoStruct.covariance_points">
<code class="descname">covariance_points</code><span class="sig-paren">(</span><em>x0</em>, <em>y0</em>, <em>xother</em>, <em>yother</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GeoStruct.covariance_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.covariance_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the covariance between point x0,y0 and the points
contained in xother, yother.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<em>(</em><em>float</em><em>)</em>) – x-coordinate</li>
<li><strong>y0</strong> (<em>(</em><em>float</em><em>)</em>) – y-coordinate</li>
<li><strong>xother</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – x-coordinate of other points</li>
<li><strong>yother</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – y-coordinate of other points</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cov</strong> – a 1-D array of covariance between point x0,y0 and the
points contained in xother, yother.  len(cov) = len(xother) =
len(yother)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.utils.geostats.GeoStruct.sill">
<code class="descname">sill</code><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.sill" title="Permalink to this definition">¶</a></dt>
<dd><p>get the sill of the GeoStruct</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>sill</strong> – the sill of the (nested) GeoStruct, including nugget and contribution
from each variogram</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.GeoStruct.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GeoStruct.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GeoStruct.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>make a cheap plot of the GeoStruct</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> (<em>(</em><em>dict</em><em>)</em>) – keyword arguments to use for plotting.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ax</strong> – the axis with the GeoStruct plot</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">matplotlib.pyplot.axis</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">optional arguments include “ax” (an existing axis),
“individuals” (plot each variogram on a separate axis),
“legend” (add a legend to the plot(s)).  All other kwargs
are passed to matplotlib.pyplot.plot()</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyemu.utils.geostats.OrdinaryKrige">
<em class="property">class </em><code class="descclassname">pyemu.utils.geostats.</code><code class="descname">OrdinaryKrige</code><span class="sig-paren">(</span><em>geostruct</em>, <em>point_data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#OrdinaryKrige"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Ordinary Kriging using Pandas and Numpy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>geostruct</strong> (<em>(</em><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct" title="pyemu.utils.geostats.GeoStruct"><em>GeoStruct</em></a><em>)</em>) – a pyemu.geostats.GeoStruct to use for the kriging</li>
<li><strong>point_data</strong> (<em>(</em><em>pandas.DataFrame</em><em>)</em>) – the conditioning points to use for kriging.  point_data must contain
columns “name”, “x”, “y”.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>if point_data is an str, then it is assumed to be a pilot points file
and is loaded as such using pyemu.pp_utils.pp_file_to_dataframe()</p>
<p class="last">If zoned interpolation is used for grid-based interpolation, then
point_data must also contain a “zone” column</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;v</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.ExpVario(a=1000,contribution=1.0)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;gs</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.GeoStruct(variograms=v,nugget=0.5)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pp_df</span> <span class="pre">=</span> <span class="pre">pyemu.pp_utils.pp_file_to_dataframe(&quot;hkpp.dat&quot;)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;ok</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.OrdinaryKrige(gs,pp_df)</span></code></p>
</div>
<dl class="method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.check_point_data_dist">
<code class="descname">check_point_data_dist</code><span class="sig-paren">(</span><em>rectify=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#OrdinaryKrige.check_point_data_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.check_point_data_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>check for point_data entries that are closer than
EPSILON distance - this will cause a singular kriging matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rectify</strong> (<em>(</em><em>boolean</em><em>)</em>) – flag to fix the problems with point_data
by dropping additional points that are
closer than EPSILON distance.  Default is False</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this method will issue warnings for points that are closer
than EPSILON distance</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.calc_factors_grid">
<code class="descname">calc_factors_grid</code><span class="sig-paren">(</span><em>spatial_reference</em>, <em>zone_array=None</em>, <em>minpts_interp=1</em>, <em>maxpts_interp=20</em>, <em>search_radius=10000000000.0</em>, <em>verbose=False</em>, <em>var_filename=None</em>, <em>forgive=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#OrdinaryKrige.calc_factors_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.calc_factors_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate kriging factors (weights) for a structured grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>spatial_reference</strong> (<em>(</em><em>flopy.utils.reference.SpatialReference</em><em>)</em>) – a spatial reference that describes the orientation and
spatail projection of the the structured grid</li>
<li><strong>zone_array</strong> (<em>(</em><em>numpy.ndarray</em><em>)</em>) – an integer array of zones to use for kriging.  If not None,
then point_data must also contain a “zone” column.  point_data
entries with a zone value not found in zone_array will be skipped.
If None, then all point_data will (potentially) be used for
interpolating each grid node. Default is None</li>
<li><strong>minpts_interp</strong> (<em>(</em><em>int</em><em>)</em>) – minimum number of point_data entires to use for interpolation at
a given grid node.  grid nodes with less than minpts_interp
point_data found will be skipped (assigned np.NaN).  Defaut is 1</li>
<li><strong>maxpts_interp</strong> (<em>(</em><em>int</em><em>)</em>) – maximum number of point_data entries to use for interpolation at
a given grid node.  A larger maxpts_interp will yield “smoother”
interplation, but using a large maxpts_interp will slow the
(already) slow kriging solution process and may lead to
memory errors. Default is 20.</li>
<li><strong>search_radius</strong> (<em>(</em><em>float</em><em>)</em>) – the size of the region around a given grid node to search for
point_data entries. Default is 1.0e+10</li>
<li><strong>verbose</strong> (<em>(</em><em>boolean</em><em>)</em>) – a flag to  echo process to stdout during the interpolatino process.
Default is False</li>
<li><strong>var_filename</strong> (<em>(</em><em>str</em><em>)</em>) – a filename to save the kriging variance for each interpolated grid node.
Default is None.</li>
<li><strong>forgive</strong> (<em>(</em><em>boolean</em><em>)</em>) – flag to continue if inversion of the kriging matrix failes at one or more
grid nodes.  Inversion usually fails if the kriging matrix is singular,
resulting from point_data entries closer than EPSILON distance.  If True,
warnings are issued for each failed inversion.  If False, an exception
is raised for failed matrix inversion.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with information summarizing the ordinary kriging
process for each grid node</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this method calls OrdinaryKrige.calc_factors()</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">flopy</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;v</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.ExpVario(a=1000,contribution=1.0)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;gs</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.GeoStruct(variograms=v,nugget=0.5)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pp_df</span> <span class="pre">=</span> <span class="pre">pyemu.pp_utils.pp_file_to_dataframe(&quot;hkpp.dat&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;ok</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.OrdinaryKrige(gs,pp_df)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;m</span> <span class="pre">=</span> <span class="pre">flopy.modflow.Modflow.load(&quot;mymodel.nam&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;df</span> <span class="pre">=</span> <span class="pre">ok.calc_factors_grid(m.sr,zone_array=m.bas6.ibound[0].array,</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">var_filename=&quot;ok_var.dat&quot;)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;ok.to_grid_factor_file(&quot;factors.dat&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.calc_factors">
<code class="descname">calc_factors</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>minpts_interp=1</em>, <em>maxpts_interp=20</em>, <em>search_radius=10000000000.0</em>, <em>verbose=False</em>, <em>pt_zone=None</em>, <em>forgive=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#OrdinaryKrige.calc_factors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.calc_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate ordinary kriging factors (weights) for the points
represented by arguments x and y</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – x-coordinates to calculate kriging factors for</li>
<li><strong>y</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – y-coordinates to calculate kriging factors for</li>
<li><strong>minpts_interp</strong> (<em>(</em><em>int</em><em>)</em>) – minimum number of point_data entires to use for interpolation at
a given x,y interplation point.  interpolation points with less
than minpts_interp point_data found will be skipped
(assigned np.NaN).  Defaut is 1</li>
<li><strong>maxpts_interp</strong> (<em>(</em><em>int</em><em>)</em>) – maximum number of point_data entries to use for interpolation at
a given x,y interpolation point.  A larger maxpts_interp will
yield “smoother” interplation, but using a large maxpts_interp
will slow the (already) slow kriging solution process and may
lead to memory errors. Default is 20.</li>
<li><strong>search_radius</strong> (<em>(</em><em>float</em><em>)</em>) – the size of the region around a given x,y interpolation point to search for
point_data entries. Default is 1.0e+10</li>
<li><strong>verbose</strong> (<em>(</em><em>boolean</em><em>)</em>) – a flag to  echo process to stdout during the interpolatino process.
Default is False</li>
<li><strong>forgive</strong> (<em>(</em><em>boolean</em><em>)</em>) – flag to continue if inversion of the kriging matrix failes at one or more
interpolation points.  Inversion usually fails if the kriging matrix is singular,
resulting from point_data entries closer than EPSILON distance.  If True,
warnings are issued for each failed inversion.  If False, an exception
is raised for failed matrix inversion.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with information summarizing the ordinary kriging
process for each interpolation points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.OrdinaryKrige.to_grid_factors_file">
<code class="descname">to_grid_factors_file</code><span class="sig-paren">(</span><em>filename</em>, <em>points_file='points.junk'</em>, <em>zone_file='zone.junk'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#OrdinaryKrige.to_grid_factors_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.OrdinaryKrige.to_grid_factors_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a grid-based PEST-style factors file.  This file can be used with
the fac2real() method to write an interpolated structured array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>(</em><em>str</em><em>)</em>) – factor filename</li>
<li><strong>points_file</strong> (<em>(</em><em>str</em><em>)</em>) – points filename to add to the header of the factors file.
Not used by fac2real() method.  Default is “points.junk”</li>
<li><strong>zone_file</strong> (<em>(</em><em>str</em><em>)</em>) – zone filename to add to the header of the factors file.
Not used by fac2real() method.  Default is “zone.junk”</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this method should be called after OrdinaryKirge.calc_factors_grid()</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyemu.utils.geostats.Vario2d">
<em class="property">class </em><code class="descclassname">pyemu.utils.geostats.</code><code class="descname">Vario2d</code><span class="sig-paren">(</span><em>contribution</em>, <em>a</em>, <em>anisotropy=1.0</em>, <em>bearing=0.0</em>, <em>name='var1'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>base class for 2-D variograms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>contribution</strong> (<em>(</em><em>float</em><em>)</em>) – sill of the variogram</li>
<li><strong>a</strong> (<em>(</em><em>float</em><em>)</em>) – (practical) range of correlation</li>
<li><strong>anisotropy</strong> (<em>(</em><em>float</em><em>)</em>) – Anisotropy ratio. Default is 1.0</li>
<li><strong>bearing</strong> (<em>(</em><em>float</em><em>)</em>) – angle in degrees East of North corresponding to anisotropy ellipse.
Default is 0.0</li>
<li><strong>name</strong> (<em>(</em><em>str</em><em>)</em>) – name of the variogram.  Default is “var1”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Vario2d</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.utils.geostats.Vario2d" title="pyemu.utils.geostats.Vario2d">Vario2d</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This base class should not be instantiated directly as it does not implement
an h_function() method.</p>
</div>
<dl class="method">
<dt id="pyemu.utils.geostats.Vario2d.to_struct_file">
<code class="descname">to_struct_file</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d.to_struct_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.to_struct_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write the Vario2d to a PEST-style structure file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> (<em>(</em><em>str</em><em> or </em><em>file handle</em><em>)</em>) – item to write to</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.utils.geostats.Vario2d.bearing_rads">
<code class="descname">bearing_rads</code><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.bearing_rads" title="Permalink to this definition">¶</a></dt>
<dd><p>get the bearing of the Vario2d in radians</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>bearing_rads</strong> – the Vario2d bearing in radians</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyemu.utils.geostats.Vario2d.rotation_coefs">
<code class="descname">rotation_coefs</code><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.rotation_coefs" title="Permalink to this definition">¶</a></dt>
<dd><p>get the rotation coefficents in radians</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>rotation_coefs</strong> – the rotation coefficients implied by Vario2d.bearing</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.Vario2d.inv_h">
<code class="descname">inv_h</code><span class="sig-paren">(</span><em>h</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d.inv_h"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.inv_h" title="Permalink to this definition">¶</a></dt>
<dd><p>the inverse of the h_function.  Used for plotting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>h</strong> (<em>(</em><em>float</em><em>)</em>) – the value of h_function to invert</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>inv_h</strong> – the inverse of h</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.Vario2d.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>get a cheap plot of the Vario2d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**kwargs</strong> (<em>(</em><em>dict</em><em>)</em>) – keyword arguments to use for plotting</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ax</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">matplotlib.pyplot.axis</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">optional arguments in kwargs include
“ax” (existing matplotlib.pyplot.axis).  Other
kwargs are passed to matplotlib.pyplot.plot()</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.Vario2d.add_sparse_covariance_matrix">
<code class="descname">add_sparse_covariance_matrix</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>names</em>, <em>iidx</em>, <em>jidx</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d.add_sparse_covariance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.add_sparse_covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>build a pyemu.SparseMatrix instance implied by Vario2d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – x-coordinate locations</li>
<li><strong>y</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – y-coordinate locations</li>
<li><strong>names</strong> (<em>(</em><em>iterable of str</em><em>)</em>) – names of locations. If None, cov must not be None</li>
<li><strong>iidx</strong> (<em>1-D ndarray</em>) – i row indices</li>
<li><strong>jidx</strong> (<em>1-D ndarray</em>) – j col indices</li>
<li><strong>data</strong> (<em>1-D ndarray</em>) – nonzero entries</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.Vario2d.covariance_matrix">
<code class="descname">covariance_matrix</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>names=None</em>, <em>cov=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d.covariance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>build a pyemu.Cov instance implied by Vario2d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – x-coordinate locations</li>
<li><strong>y</strong> (<em>(</em><em>iterable of floats</em><em>)</em>) – y-coordinate locations</li>
<li><strong>names</strong> (<em>(</em><em>iterable of str</em><em>)</em>) – names of locations. If None, cov must not be None</li>
<li><strong>cov</strong> (<em>(</em><em>pyemu.Cov</em><em>)</em>) – an existing Cov instance.  Vario2d contribution is added to cov</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cov</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.Cov</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">either names or cov must not be None.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.Vario2d.covariance_points">
<code class="descname">covariance_points</code><span class="sig-paren">(</span><em>x0</em>, <em>y0</em>, <em>xother</em>, <em>yother</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d.covariance_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.covariance_points" title="Permalink to this definition">¶</a></dt>
<dd><p>get the covariance between base point x0,y0 and
other points xother,yother implied by Vario2d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x0</strong> (<em>(</em><em>float</em><em>)</em>) – x-coordinate of base point</li>
<li><strong>y0</strong> (<em>(</em><em>float</em><em>)</em>) – y-coordinate of base point</li>
<li><strong>xother</strong> (<em>(</em><em>float</em><em> or </em><em>numpy.ndarray</em><em>)</em>) – x-coordinates of other points</li>
<li><strong>yother</strong> (<em>(</em><em>float</em><em> or </em><em>numpy.ndarray</em><em>)</em>) – y-coordinates of other points</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cov</strong> – covariance between base point and other points implied by
Vario2d.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">len(cov) = len(xother) = len(yother)</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.geostats.Vario2d.covariance">
<code class="descname">covariance</code><span class="sig-paren">(</span><em>pt0</em>, <em>pt1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#Vario2d.covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.Vario2d.covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>get the covarince between two points implied by Vario2d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pt0</strong> (<em>(</em><em>iterable of len 2</em><em>)</em>) – first point x and y</li>
<li><strong>pt1</strong> (<em>(</em><em>iterable of len 2</em><em>)</em>) – second point x and y</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>cov</strong> – covariance between pt0 and pt1</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyemu.utils.geostats.ExpVario">
<em class="property">class </em><code class="descclassname">pyemu.utils.geostats.</code><code class="descname">ExpVario</code><span class="sig-paren">(</span><em>contribution</em>, <em>a</em>, <em>anisotropy=1.0</em>, <em>bearing=0.0</em>, <em>name='var1'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#ExpVario"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.ExpVario" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.utils.geostats.Vario2d" title="pyemu.utils.geostats.Vario2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.utils.geostats.Vario2d</span></code></a></p>
<p>Exponetial variogram derived type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>contribution</strong> (<em>(</em><em>float</em><em>)</em>) – sill of the variogram</li>
<li><strong>a</strong> (<em>(</em><em>float</em><em>)</em>) – (practical) range of correlation</li>
<li><strong>anisotropy</strong> (<em>(</em><em>float</em><em>)</em>) – Anisotropy ratio. Default is 1.0</li>
<li><strong>bearing</strong> (<em>(</em><em>float</em><em>)</em>) – angle in degrees East of North corresponding to anisotropy ellipse.
Default is 0.0</li>
<li><strong>name</strong> (<em>(</em><em>str</em><em>)</em>) – name of the variogram.  Default is “var1”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ExpVario</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.utils.geostats.ExpVario" title="pyemu.utils.geostats.ExpVario">ExpVario</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;v</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.ExpVario(a=1000,contribution=1.0)</span></code></p>
</div>
</dd></dl>

<dl class="class">
<dt id="pyemu.utils.geostats.GauVario">
<em class="property">class </em><code class="descclassname">pyemu.utils.geostats.</code><code class="descname">GauVario</code><span class="sig-paren">(</span><em>contribution</em>, <em>a</em>, <em>anisotropy=1.0</em>, <em>bearing=0.0</em>, <em>name='var1'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#GauVario"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.GauVario" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.utils.geostats.Vario2d" title="pyemu.utils.geostats.Vario2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.utils.geostats.Vario2d</span></code></a></p>
<p>Gaussian variogram derived type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>contribution</strong> (<em>(</em><em>float</em><em>)</em>) – sill of the variogram</li>
<li><strong>a</strong> (<em>(</em><em>float</em><em>)</em>) – (practical) range of correlation</li>
<li><strong>anisotropy</strong> (<em>(</em><em>float</em><em>)</em>) – Anisotropy ratio. Default is 1.0</li>
<li><strong>bearing</strong> (<em>(</em><em>float</em><em>)</em>) – angle in degrees East of North corresponding to anisotropy ellipse.
Default is 0.0</li>
<li><strong>name</strong> (<em>(</em><em>str</em><em>)</em>) – name of the variogram.  Default is “var1”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>GauVario</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.utils.geostats.GauVario" title="pyemu.utils.geostats.GauVario">GauVario</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the Gaussian variogram can be unstable (not invertible) for long ranges.</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;v</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.GauVario(a=1000,contribution=1.0)</span></code></p>
</div>
</dd></dl>

<dl class="class">
<dt id="pyemu.utils.geostats.SphVario">
<em class="property">class </em><code class="descclassname">pyemu.utils.geostats.</code><code class="descname">SphVario</code><span class="sig-paren">(</span><em>contribution</em>, <em>a</em>, <em>anisotropy=1.0</em>, <em>bearing=0.0</em>, <em>name='var1'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#SphVario"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.SphVario" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyemu.utils.geostats.Vario2d" title="pyemu.utils.geostats.Vario2d"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyemu.utils.geostats.Vario2d</span></code></a></p>
<p>Spherical variogram derived type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>contribution</strong> (<em>(</em><em>float</em><em>)</em>) – sill of the variogram</li>
<li><strong>a</strong> (<em>(</em><em>float</em><em>)</em>) – (practical) range of correlation</li>
<li><strong>anisotropy</strong> (<em>(</em><em>float</em><em>)</em>) – Anisotropy ratio. Default is 1.0</li>
<li><strong>bearing</strong> (<em>(</em><em>float</em><em>)</em>) – angle in degrees East of North corresponding to anisotropy ellipse.
Default is 0.0</li>
<li><strong>name</strong> (<em>(</em><em>str</em><em>)</em>) – name of the variogram.  Default is “var1”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>SphVario</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.utils.geostats.SphVario" title="pyemu.utils.geostats.SphVario">SphVario</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;v</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.SphVario(a=1000,contribution=1.0)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.geostats.read_struct_file">
<code class="descclassname">pyemu.utils.geostats.</code><code class="descname">read_struct_file</code><span class="sig-paren">(</span><em>struct_file</em>, <em>return_type=&lt;class 'pyemu.utils.geostats.GeoStruct'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#read_struct_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.read_struct_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read an existing PEST-type structure file into a GeoStruct instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>struct_file</strong> (<em>(</em><em>str</em><em>)</em>) – existing pest-type structure file</li>
<li><strong>return_type</strong> (<em>(</em><em>object</em><em>)</em>) – the instance type to return.  Default is GeoStruct</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>GeoStruct</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list or <a class="reference internal" href="#pyemu.utils.geostats.GeoStruct" title="pyemu.utils.geostats.GeoStruct">GeoStruct</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if only on structure is listed in struct_file, then return type
is GeoStruct.  Otherwise, return type is a list of GeoStruct</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;gs</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.reads_struct_file(&quot;struct.dat&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.geostats.read_sgems_variogram_xml">
<code class="descclassname">pyemu.utils.geostats.</code><code class="descname">read_sgems_variogram_xml</code><span class="sig-paren">(</span><em>xml_file</em>, <em>return_type=&lt;class 'pyemu.utils.geostats.GeoStruct'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#read_sgems_variogram_xml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.read_sgems_variogram_xml" title="Permalink to this definition">¶</a></dt>
<dd><p>function to read an SGEMS-type variogram XML file into
a GeoStruct</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xml_file</strong> (<em>(</em><em>str</em><em>)</em>) – SGEMS variogram XML file</li>
<li><strong>return_type</strong> (<em>(</em><em>object</em><em>)</em>) – the instance type to return.  Default is GeoStruct</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>GeoStruct</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.utils.geostats.GeoStruct" title="pyemu.utils.geostats.GeoStruct">GeoStruct</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;gs</span> <span class="pre">=</span> <span class="pre">pyemu.utils.geostats.read_sgems_variogram_xml(&quot;sgems.xml&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.geostats.gslib_2_dataframe">
<code class="descclassname">pyemu.utils.geostats.</code><code class="descname">gslib_2_dataframe</code><span class="sig-paren">(</span><em>filename</em>, <em>attr_name=None</em>, <em>x_idx=0</em>, <em>y_idx=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#gslib_2_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.gslib_2_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>function to read a GSLIB point data file into a pandas.DataFrame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>(</em><em>str</em><em>)</em>) – GSLIB file</li>
<li><strong>attr_name</strong> (<em>(</em><em>str</em><em>)</em>) – the column name in the dataframe for the attribute.  If None, GSLIB file
can have only 3 columns.  attr_name must be in the GSLIB file header</li>
<li><strong>x_idx</strong> (<em>(</em><em>int</em><em>)</em>) – the index of the x-coordinate information in the GSLIB file. Default is
0 (first column)</li>
<li><strong>y_idx</strong> (<em>(</em><em>int</em><em>)</em>) – the index of the y-coordinate information in the GSLIB file.
Default is 1 (second column)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">pandas.DataFrame</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last">exception if attr_name is None and GSLIB file has more than 3 columns</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">assigns generic point names (“pt0, pt1, etc)</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;df</span> <span class="pre">=</span> <span class="pre">pyemu.utiils.geostats.gslib_2_dataframe(&quot;prop.gslib&quot;,attr_name=&quot;hk&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.geostats.load_sgems_exp_var">
<code class="descclassname">pyemu.utils.geostats.</code><code class="descname">load_sgems_exp_var</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#load_sgems_exp_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.load_sgems_exp_var" title="Permalink to this definition">¶</a></dt>
<dd><p>read an SGEM experimental variogram into a sequence of
pandas.DataFrames</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>(</em><em>str</em><em>)</em>) – an SGEMS experimental variogram XML file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>dfs</strong> – a list of pandas.DataFrames of x, y, pairs for each
division in the experimental variogram</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.geostats.fac2real">
<code class="descclassname">pyemu.utils.geostats.</code><code class="descname">fac2real</code><span class="sig-paren">(</span><em>pp_file=None</em>, <em>factors_file='factors.dat'</em>, <em>out_file='test.ref'</em>, <em>upper_lim=1e+30</em>, <em>lower_lim=-1e+30</em>, <em>fill_value=1e+30</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#fac2real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.fac2real" title="Permalink to this definition">¶</a></dt>
<dd><p>A python replication of the PEST fac2real utility for creating a
structure grid array from previously calculated kriging factors (weights)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pp_file</strong> (<em>(</em><em>str</em><em>)</em>) – PEST-type pilot points file</li>
<li><strong>factors_file</strong> (<em>(</em><em>str</em><em>)</em>) – PEST-style factors file</li>
<li><strong>out_file</strong> (<em>(</em><em>str</em><em>)</em>) – filename of array to write.  If None, array is returned, else
value of out_file is returned.  Default is “test.ref”.</li>
<li><strong>upper_lim</strong> (<em>(</em><em>float</em><em>)</em>) – maximum interpolated value in the array.  Values greater than
upper_lim are set to fill_value</li>
<li><strong>lower_lim</strong> (<em>(</em><em>float</em><em>)</em>) – minimum interpolated value in the array.  Values less than lower_lim
are set to fill_value</li>
<li><strong>fill_value</strong> (<em>(</em><em>float</em><em>)</em>) – the value to assign array nodes that are not interpolated</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>arr</strong> (<em>numpy.ndarray</em>) – if out_file is None</li>
<li><strong>out_file</strong> (<em>str</em>) – if out_file it not None</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pyemu.utils.geostats.fac2real(&quot;hkpp.dat&quot;,out_file=&quot;hk_layer_1.ref&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.geostats.parse_factor_line">
<code class="descclassname">pyemu.utils.geostats.</code><code class="descname">parse_factor_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/geostats.html#parse_factor_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.geostats.parse_factor_line" title="Permalink to this definition">¶</a></dt>
<dd><p>function to parse a factor file line.  Used by fac2real()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>line</strong> (<em>(</em><em>str</em><em>)</em>) – a factor line from a factor file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>inode</strong> (<em>int</em>) – the inode of the grid node</li>
<li><strong>itrans</strong> (<em>int</em>) – flag for transformation of the grid node</li>
<li><strong>fac_data</strong> (<em>dict</em>) – a dictionary of point number, factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.gw_utils">
<span id="pyemu-utils-gw-utils-module"></span><h2>pyemu.utils.gw_utils module<a class="headerlink" href="#module-pyemu.utils.gw_utils" title="Permalink to this headline">¶</a></h2>
<p>module of utilities for groundwater modeling</p>
<dl class="function">
<dt id="pyemu.utils.gw_utils.modflow_pval_to_template_file">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">modflow_pval_to_template_file</code><span class="sig-paren">(</span><em>pval_file</em>, <em>tpl_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#modflow_pval_to_template_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_pval_to_template_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for a modflow parameter value file.
Uses names in the first column in the pval file as par names.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pval_file</strong> (<em>str</em>) – parameter value file</li>
<li><strong>tpl_file</strong> (<em>str</em><em>, </em><em>optional</em>) – template file to write.  If None, use &lt;pval_file&gt;.tpl.
Default is None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – pandas DataFrame with control file parameter information</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.modflow_hob_to_instruction_file">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">modflow_hob_to_instruction_file</code><span class="sig-paren">(</span><em>hob_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#modflow_hob_to_instruction_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_hob_to_instruction_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write an instruction file for a modflow head observation file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hob_file</strong> (<em>str</em>) – modflow hob file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>df</strong> – pandas DataFrame with control file observation information</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.modflow_hydmod_to_instruction_file">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">modflow_hydmod_to_instruction_file</code><span class="sig-paren">(</span><em>hydmod_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#modflow_hydmod_to_instruction_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_hydmod_to_instruction_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write an instruction file for a modflow hydmod file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hydmod_file</strong> (<em>str</em>) – modflow hydmod file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>df</strong> – pandas DataFrame with control file observation information</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">calls modflow_read_hydmod_file()</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.modflow_read_hydmod_file">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">modflow_read_hydmod_file</code><span class="sig-paren">(</span><em>hydmod_file</em>, <em>hydmod_outfile=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#modflow_read_hydmod_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_read_hydmod_file" title="Permalink to this definition">¶</a></dt>
<dd><p>read in a binary hydmod file and return a dataframe of the results</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hydmod_file</strong> (<em>str</em>) – modflow hydmod binary file</li>
<li><strong>hydmod_outfile</strong> (<em>str</em>) – output file to write.  If None, use &lt;hydmod_file&gt;.dat.
Default is None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – pandas DataFrame with hymod_file values</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">requires flopy</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_pilotpoints_grid">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_pilotpoints_grid</code><span class="sig-paren">(</span><em>ml=None</em>, <em>sr=None</em>, <em>ibound=None</em>, <em>prefix_dict=None</em>, <em>every_n_cell=4</em>, <em>use_ibound_zones=False</em>, <em>pp_dir='.'</em>, <em>tpl_dir='.'</em>, <em>shapename='pp.shp'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_pilotpoints_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_pilotpoints_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>setup regularly-spaced (gridded) pilot point parameterization</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ml</strong> (<em>flopy.mbase</em>) – a flopy mbase dervied type.  If None, sr must not be None.</li>
<li><strong>sr</strong> (<em>flopy.utils.reference.SpatialReference</em>) – a spatial reference use to locate the model grid in space.  If None,
ml must not be None.  Default is None</li>
<li><strong>ibound</strong> (<em>numpy.ndarray</em>) – the modflow ibound integer array.  Used to set pilot points only in active areas.
If None and ml is None, then pilot points are set in all rows and columns according to
every_n_cell.  Default is None.</li>
<li><strong>prefix_dict</strong> (<em>dict</em>) – a dictionary of pilot point parameter prefix, layer pairs.  example : {“hk”:[0,1,2,3]} would
setup pilot points with the prefix “hk” for model layers 1 - 4 (zero based). If None, a generic set
of pilot points with the “pp” prefix are setup for a generic nrowXncol grid. Default is None</li>
<li><strong>use_ibound_zones</strong> (<em>bool</em>) – a flag to use the greater-than-zero values in the ibound as pilot point zones.  If False,ibound
values greater than zero are treated as a single zone.  Default is False.</li>
<li><strong>pp_dir</strong> (<em>str</em>) – directory to write pilot point files to.  Default is ‘.’</li>
<li><strong>tpl_dir</strong> (<em>str</em>) – directory to write pilot point template file to.  Default is ‘.’</li>
<li><strong>shapename</strong> (<em>str</em>) – name of shapefile to write that containts pilot point information. Default is “pp.shp”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pp_df</strong> – a dataframe summarizing pilot point information (same information
written to shapename</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.pp_file_to_dataframe">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">pp_file_to_dataframe</code><span class="sig-paren">(</span><em>pp_filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#pp_file_to_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.pp_file_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.pp_tpl_to_dataframe">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">pp_tpl_to_dataframe</code><span class="sig-paren">(</span><em>tpl_filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#pp_tpl_to_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.pp_tpl_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.write_pp_shapfile">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">write_pp_shapfile</code><span class="sig-paren">(</span><em>pp_df</em>, <em>shapename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#write_pp_shapfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.write_pp_shapfile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.write_pp_file">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">write_pp_file</code><span class="sig-paren">(</span><em>filename</em>, <em>pp_df</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#write_pp_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.write_pp_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.pilot_points_to_tpl">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">pilot_points_to_tpl</code><span class="sig-paren">(</span><em>pp_file</em>, <em>tpl_file=None</em>, <em>name_prefix=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#pilot_points_to_tpl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.pilot_points_to_tpl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.fac2real">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">fac2real</code><span class="sig-paren">(</span><em>pp_file=None</em>, <em>factors_file='factors.dat'</em>, <em>out_file='test.ref'</em>, <em>upper_lim=1e+30</em>, <em>lower_lim=-1e+30</em>, <em>fill_value=1e+30</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#fac2real"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.fac2real" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_mtlist_budget_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_mtlist_budget_obs</code><span class="sig-paren">(</span><em>list_filename</em>, <em>gw_filename='mtlist_gw.dat'</em>, <em>sw_filename='mtlist_sw.dat'</em>, <em>start_datetime='1-1-1970'</em>, <em>gw_prefix='gw'</em>, <em>sw_prefix='sw'</em>, <em>save_setup_file=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_mtlist_budget_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_mtlist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations of gw (and optionally sw) mass budgets from mt3dusgs list file.  writes
an instruction file and also a _setup_.csv to use when constructing a pest
control file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>list_filename</strong> (<em>str</em>) – modflow list file</li>
<li><strong>gw_filename</strong> (<em>str</em>) – output filename that will contain the gw budget observations. Default is
“mtlist_gw.dat”</li>
<li><strong>sw_filename</strong> (<em>str</em>) – output filename that will contain the sw budget observations. Default is
“mtlist_sw.dat”</li>
<li><strong>start_datetime</strong> (<em>str</em>) – an str that can be parsed into a pandas.TimeStamp.  used to give budget
observations meaningful names</li>
<li><strong>gw_prefix</strong> (<em>str</em>) – a prefix to add to the GW budget observations.  Useful if processing
more than one list file as part of the forward run process. Default is ‘gw’.</li>
<li><strong>sw_prefix</strong> (<em>str</em>) – a prefix to add to the SW budget observations.  Useful if processing
more than one list file as part of the forward run process. Default is ‘sw’.</li>
<li><strong>save_setup_file</strong> (<em>(</em><em>boolean</em><em>)</em>) – a flag to save _setup_&lt;list_filename&gt;.csv file that contains useful
control file information</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>frun_line, ins_filenames, df</strong> – the command to add to the forward run script, the names of the instruction
files and a dataframe with information for constructing a control file.  If INSCHEK fails
to run, df = None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str, list(str), pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This function uses INSCHEK to get observation values; the observation values are
the values of the list file list_filename.  If INSCHEK fails to run, the obseravtion
values are set to 1.0E+10</p>
<p>the instruction files are named &lt;out_filename&gt;.ins</p>
<p class="last">It is recommended to use the default value for gw_filename or sw_filename.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_mtlist_budget_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_mtlist_budget_obs</code><span class="sig-paren">(</span><em>list_filename</em>, <em>gw_filename='mtlist_gw.dat'</em>, <em>sw_filename='mtlist_sw.dat'</em>, <em>start_datetime='1-1-1970'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_mtlist_budget_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_mtlist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process an MT3D list file to extract mass budget entries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>list_filename</strong> (<em>str</em>) – the mt3d list file</li>
<li><strong>gw_filename</strong> (<em>str</em>) – the name of the output file with gw mass budget information.
Default is “mtlist_gw.dat”</li>
<li><strong>sw_filename</strong> (<em>str</em>) – the name of the output file with sw mass budget information.
Default is “mtlist_sw.dat”</li>
<li><strong>start_datatime</strong> (<em>str</em>) – an str that can be cast to a pandas.TimeStamp.  Used to give
observations a meaningful name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>gw</strong> (<em>pandas.DataFrame</em>) – the gw mass dataframe</li>
<li><strong>sw</strong> (<em>pandas.DataFrame (optional)</em>) – the sw mass dataframe</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>requires flopy</p>
<p class="last">if SFT is not active, no SW mass budget will be returned</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_mflist_budget_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_mflist_budget_obs</code><span class="sig-paren">(</span><em>list_filename</em>, <em>flx_filename='flux.dat'</em>, <em>vol_filename='vol.dat'</em>, <em>start_datetime=&quot;1-1'1970&quot;</em>, <em>prefix=''</em>, <em>save_setup_file=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_mflist_budget_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_mflist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations of budget volume and flux from modflow list file.  writes
an instruction file and also a _setup_.csv to use when constructing a pest
control file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>list_filename</strong> (<em>str</em>) – modflow list file</li>
<li><strong>flx_filename</strong> (<em>str</em>) – output filename that will contain the budget flux observations. Default is
“flux.dat”</li>
<li><strong>vol_filename</strong> (<em>str</em><em>)</em>) – output filename that will contain the budget volume observations.  Default
is “vol.dat”</li>
<li><strong>start_datetime</strong> (<em>str</em>) – an str that can be parsed into a pandas.TimeStamp.  used to give budget
observations meaningful names</li>
<li><strong>prefix</strong> (<em>str</em>) – a prefix to add to the water budget observations.  Useful if processing
more than one list file as part of the forward run process. Default is ‘’.</li>
<li><strong>save_setup_file</strong> (<em>(</em><em>boolean</em><em>)</em>) – a flag to save _setup_&lt;list_filename&gt;.csv file that contains useful
control file information</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with information for constructing a control file.  If INSCHEK fails
to run, reutrns None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This function uses INSCHEK to get observation values; the observation values are
the values of the list file list_filename.  If INSCHEK fails to run, the obseravtion
values are set to 1.0E+10</p>
<p>the instruction files are named &lt;flux_file&gt;.ins and &lt;vol_file&gt;.ins, respectively</p>
<p class="last">It is recommended to use the default values for flux_file and vol_file.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_mflist_budget_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_mflist_budget_obs</code><span class="sig-paren">(</span><em>list_filename</em>, <em>flx_filename='flux.dat'</em>, <em>vol_filename='vol.dat'</em>, <em>start_datetime='1-1-1970'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_mflist_budget_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_mflist_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process a MODFLOW list file to extract flux and volume water budget entries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>list_filename</strong> (<em>str</em>) – the modflow list file</li>
<li><strong>flx_filename</strong> (<em>str</em>) – the name of the output file with water budget flux information.
Default is “flux.dat”</li>
<li><strong>vol_filename</strong> (<em>str</em>) – the name of the output file with water budget volume information.
Default is “vol.dat”</li>
<li><strong>start_datatime</strong> (<em>str</em>) – an str that can be cast to a pandas.TimeStamp.  Used to give
observations a meaningful name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>flx</strong> (<em>pandas.DataFrame</em>) – the flux dataframe</li>
<li><strong>vol</strong> (<em>pandas.DataFrame</em>) – the volume dataframe</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">requires flopy</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_hds_timeseries">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_hds_timeseries</code><span class="sig-paren">(</span><em>hds_file</em>, <em>kij_dict</em>, <em>prefix=None</em>, <em>include_path=False</em>, <em>model=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_hds_timeseries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_hds_timeseries" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to setup extracting time-series from a binary modflow
head save (or equivalent format - ucn, sub, etc).  Writes
an instruction file and a _set_ csv</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>hds_file</strong> (<em>str</em>) – binary filename</li>
<li><strong>kij_dict</strong> (<em>dict</em>) – dictionary of site_name: [k,i,j] pairs</li>
<li><strong>prefix</strong> (<em>str</em>) – string to prepend to site_name when forming obsnme’s.  Default is None</li>
<li><strong>include_path</strong> (<em>bool</em>) – flag to prepend hds_file path. Useful for setting up
process in separate directory for where python is running.</li>
<li><strong>model</strong> (<em>flopy.mbase</em>) – a flopy model.  If passed, the observation names will have the datetime of the
observation appended to them.  If None, the observation names will have the
stress period appended to them. Default is None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This function writes hds_timeseries.config that must be in the same
dir where apply_hds_timeseries() is called during the forward run</p>
<p class="last">assumes model time units are days!!!</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_hds_timeseries">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_hds_timeseries</code><span class="sig-paren">(</span><em>config_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_hds_timeseries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_hds_timeseries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_hds_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_hds_obs</code><span class="sig-paren">(</span><em>hds_file</em>, <em>kperk_pairs=None</em>, <em>skip=None</em>, <em>prefix='hds'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_hds_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_hds_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to setup using all values from a
layer-stress period pair for observations.  Writes
an instruction file and a _setup_ csv used
construct a control file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hds_file</strong> (<em>str</em>) – a MODFLOW head-save file.  If the hds_file endswith ‘ucn’,
then the file is treated as a UcnFile type.</li>
<li><strong>kperk_pairs</strong> (<em>iterable</em>) – an iterable of pairs of kper (zero-based stress
period index) and k (zero-based layer index) to
setup observations for.  If None, then a shit-ton
of observations may be produced!</li>
<li><strong>skip</strong> (<em>variable</em>) – a value or function used to determine which values
to skip when setting up observations.  If np.scalar(skip)
is True, then values equal to skip will not be used.  If not
np.scalar(skip), then skip will be treated as a lambda function that
returns np.NaN if the value should be skipped.</li>
<li><strong>prefix</strong> (<em>str</em>) – the prefix to use for the observation names. default is “hds”.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(forward_run_line, df)</strong> – a python code str to add to the forward run script and the setup info for the observations</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str, pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>requires flopy</p>
<p>writes &lt;hds_file&gt;.dat.ins instruction file</p>
<p class="last">writes _setup_&lt;hds_file&gt;.csv which contains much
useful information for construction a control file</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.last_kstp_from_kper">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">last_kstp_from_kper</code><span class="sig-paren">(</span><em>hds</em>, <em>kper</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#last_kstp_from_kper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.last_kstp_from_kper" title="Permalink to this definition">¶</a></dt>
<dd><p>function to find the last time step (kstp) for a
give stress period (kper) in a modflow head save file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hds</strong> (<em>flopy.utils.HeadFile</em>) – </li>
<li><strong>kper</strong> (<em>int</em>) – the zero-index stress period number</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>kstp</strong> – the zero-based last time step during stress period
kper in the head save file</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_hds_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_hds_obs</code><span class="sig-paren">(</span><em>hds_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_hds_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_hds_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>process a modflow head save file.  A companion function to
setup_hds_obs that is called during the forward run process</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hds_file</strong> (<em>str</em>) – a modflow head save filename. if hds_file ends with ‘ucn’,
then the file is treated as a UcnFile type.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>requires flopy</p>
<p>writes &lt;hds_file&gt;.dat</p>
<p>expects &lt;hds_file&gt;.dat.ins to exist</p>
<p class="last">uses pyemu.pst_utils.parse_ins_file to get observation names</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_sft_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_sft_obs</code><span class="sig-paren">(</span><em>sft_file</em>, <em>ins_file=None</em>, <em>start_datetime=None</em>, <em>times=None</em>, <em>ncomp=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_sft_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sft_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>writes an instruction file for a mt3d-usgs sft output file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sft_file</strong> (<em>str</em>) – the sft output file (ASCII)</li>
<li><strong>ins_file</strong> (<em>str</em>) – the name of the instruction file to create.  If None, the name
is &lt;sft_file&gt;.ins.  Default is None</li>
<li><strong>start_datetime</strong> (<em>str</em>) – a pandas.to_datetime() compatible str.  If not None,
then the resulting observation names have the datetime
suffix.  If None, the suffix is the output totim.  Default
is None</li>
<li><strong>times</strong> (<em>iterable</em>) – a container of times to make observations for.  If None, all times are used.
Default is None.</li>
<li><strong>ncomp</strong> (<em>int</em>) – number of components in transport model. Default is 1.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with obsnme and obsval for the sft simulated concentrations and flows.
If inschek was not successfully run, then returns None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">setups up observations for SW conc, GW conc and flowgw for all times and reaches.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_sft_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_sft_obs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_sft_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sft_obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_sfr_seg_parameters">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_sfr_seg_parameters</code><span class="sig-paren">(</span><em>nam_file, model_ws='.', par_cols=['flow', 'runoff', 'hcond1', 'hcond2', 'pptsw'], tie_hcond=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_sfr_seg_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sfr_seg_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup multiplier parameters for SFR segment data.  Just handles the
standard input case, not all the cryptic SFR options.  Loads the dis, bas, and sfr files
with flopy using model_ws.  However, expects that apply_sfr_seg_parameters() will be called
from within model_ws at runtime.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nam_file</strong> (<em>flopy.modflow.mf.Modflow</em>) – MODFLOw name file.  DIS, BAS, and SFR must be available as pathed in the nam_file</li>
<li><strong>model_ws</strong> (<em>str</em>) – model workspace for flopy to load the MODFLOW model from</li>
<li><strong>OR</strong> – </li>
<li><strong>nam_file</strong> – flopy modflow model object</li>
<li><strong>par_cols</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – segment data entires to parameterize</li>
<li><strong>tie_hcond</strong> (<em>flag to use same mult par for hcond1 and hcond2 for a given segment.  Default is True</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with useful parameter setup information</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the number (and numbering) of segment data entries must consistent across
all stress periods.
writes &lt;nam_file&gt;+”_backup_.sfr” as the backup of the original sfr file
skips values = 0.0 since multipliers don’t work for these</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_sfr_reach_parameters">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_sfr_reach_parameters</code><span class="sig-paren">(</span><em>nam_file, model_ws='.', par_cols=['strhc1']</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_sfr_reach_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sfr_reach_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup multiplier paramters for reach data, when reachinput option is specififed in sfr.
Similare to setup_sfr_seg_parameters() method will apply params to sfr reachdata
Can load the dis, bas, and sfr files with flopy using model_ws. Or can pass a model object (SFR loading can be slow)
However, expects that apply_sfr_reach_parameters() will be called
from within model_ws at runtime.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nam_file</strong> (<em>flopy.modflow.mf.Modflow</em>) – MODFLOw name file.  DIS, BAS, and SFR must be available as pathed in the nam_file</li>
<li><strong>model_ws</strong> (<em>str</em>) – model workspace for flopy to load the MODFLOW model from</li>
<li><strong>OR</strong> – </li>
<li><strong>nam_file</strong> – flopy modflow model object</li>
<li><strong>par_cols</strong> (<em>list</em><em>(</em><em>str</em><em>)</em>) – segment data entires to parameterize</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with useful parameter setup information</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">skips values = 0.0 since multipliers don’t work for these</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_sfr_seg_parameters">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_sfr_seg_parameters</code><span class="sig-paren">(</span><em>reach_pars=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_sfr_seg_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sfr_seg_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the SFR segement multiplier parameters.  Expected to be run in the same dir
as the model exists</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>reach_pars</strong> (<em>bool</em>) – if reach paramters need to be applied</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>sfr</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">flopy.modflow.ModflowSfr instance</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">expects “sfr_seg_pars.config” to exist
expects &lt;nam_file&gt;+”_backup_.sfr” to exist</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_sfr_parameters">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_sfr_parameters</code><span class="sig-paren">(</span><em>reach_pars=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_sfr_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sfr_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_sfr_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_sfr_obs</code><span class="sig-paren">(</span><em>sfr_out_file</em>, <em>seg_group_dict=None</em>, <em>ins_file=None</em>, <em>model=None</em>, <em>include_path=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_sfr_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_sfr_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations using the sfr ASCII output file.  Setups
the ability to aggregate flows for groups of segments.  Applies
only flow to aquier and flow out.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sft_out_file</strong> (<em>str</em>) – the existing SFR output file</li>
<li><strong>seg_group_dict</strong> (<em>dict</em>) – a dictionary of SFR segements to aggregate together for a single obs.
the key value in the dict is the base observation name. If None, all segments
are used as individual observations. Default is None</li>
<li><strong>model</strong> (<em>flopy.mbase</em>) – a flopy model.  If passed, the observation names will have the datetime of the
observation appended to them.  If None, the observation names will have the
stress period appended to them. Default is None.</li>
<li><strong>include_path</strong> (<em>bool</em>) – flag to prepend sfr_out_file path to sfr_obs.config.  Useful for setting up
process in separate directory for where python is running.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – dataframe of obsnme, obsval and obgnme if inschek run was successful.  Else None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pd.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function writes “sfr_obs.config” which must be kept in the dir where
“apply_sfr_obs()” is being called during the forward run</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_sfr_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_sfr_obs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_sfr_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_sfr_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>apply the sfr observation process - pairs with setup_sfr_obs().
requires sfr_obs.config.  Writes &lt;sfr_out_file&gt;.processed, where
&lt;sfr_out_file&gt; is defined in “sfr_obs.config”</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>None</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>df</strong> – a dataframe of aggregrated sfr segment aquifer and outflow</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pd.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.load_sfr_out">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">load_sfr_out</code><span class="sig-paren">(</span><em>sfr_out_file</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#load_sfr_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.load_sfr_out" title="Permalink to this definition">¶</a></dt>
<dd><p>load an ASCII SFR output file into a dictionary of kper: dataframes.  aggregates
segments and only returns flow to aquifer and flow out.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sfr_out_file</strong> (<em>str</em>) – SFR ASCII output file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>sfr_dict</strong> – dictionary of {kper:dataframe}</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.modflow_sfr_gag_to_instruction_file">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">modflow_sfr_gag_to_instruction_file</code><span class="sig-paren">(</span><em>gage_output_file</em>, <em>ins_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#modflow_sfr_gag_to_instruction_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.modflow_sfr_gag_to_instruction_file" title="Permalink to this definition">¶</a></dt>
<dd><p>writes an instruction file for an SFR gage output file to read Flow only at all times</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gage_output_file</strong> (<em>str</em>) – the gage output filename (ASCII)</li>
<li><strong>ins_file</strong> (<em>str</em>) – the name of the instruction file to create.  If None, the name
is &lt;gage_output_file&gt;.ins.  Default is None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>df</strong> (<em>pandas.DataFrame</em>) – a dataframe with obsnme and obsval for the sfr simulated flows.
If inschek was not successfully run, then returns None</li>
<li><strong>ins_file</strong> (<em>str</em>) – file name of instructions file relating to gage output.</li>
<li><strong>obs_file</strong> (<em>str</em>) – file name of processed gage output for all times</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">setups up observations for gage outputs only for the Flow column.</p>
</div>
<p>TODO : allow other observation types and align explicitly with times - now returns all values</p>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.setup_gage_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">setup_gage_obs</code><span class="sig-paren">(</span><em>gage_file</em>, <em>ins_file=None</em>, <em>start_datetime=None</em>, <em>times=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#setup_gage_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.setup_gage_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>writes an instruction file for a mt3d-usgs sft output file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gage_file</strong> (<em>str</em>) – the gage output file (ASCII)</li>
<li><strong>ins_file</strong> (<em>str</em>) – the name of the instruction file to create.  If None, the name
is &lt;gage_file&gt;.processed.ins.  Default is None</li>
<li><strong>start_datetime</strong> (<em>str</em>) – a pandas.to_datetime() compatible str.  If not None,
then the resulting observation names have the datetime
suffix.  If None, the suffix is the output totim.  Default
is None</li>
<li><strong>times</strong> (<em>iterable</em>) – a container of times to make observations for.  If None, all times are used.
Default is None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>df</strong> (<em>pandas.DataFrame</em>) – a dataframe with obsnme and obsval for the sft simulated concentrations and flows.
If inschek was not successfully run, then returns None</li>
<li><strong>ins_file</strong> (<em>str</em>) – file name of instructions file relating to gage output.</li>
<li><strong>obs_file</strong> (<em>str</em>) – file name of processed gage output (processed according to times passed above.)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">setups up observations for gage outputs (all columns).</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.apply_gage_obs">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">apply_gage_obs</code><span class="sig-paren">(</span><em>return_obs_file=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#apply_gage_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.apply_gage_obs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.write_hfb_zone_multipliers_template">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">write_hfb_zone_multipliers_template</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#write_hfb_zone_multipliers_template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.write_hfb_zone_multipliers_template" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for an hfb using multipliers per zone (double yuck!)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m</strong> (<em>flopy.modflow.Modflow instance with an HFB file</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>(hfb_mults, tpl_filename)</strong> – a dictionary with original unique HFB conductivity values and their corresponding parameter names
and the name of the template file</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(dict, str)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.gw_utils.write_hfb_template">
<code class="descclassname">pyemu.utils.gw_utils.</code><code class="descname">write_hfb_template</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/gw_utils.html#write_hfb_template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.gw_utils.write_hfb_template" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for an hfb (yuck!)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m</strong> (<em>flopy.modflow.Modflow instance with an HFB file</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>(tpl_filename, df)</strong> – the name of the template file and a dataframe with useful info.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(str, pandas.DataFrame)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.helpers">
<span id="pyemu-utils-helpers-module"></span><h2>pyemu.utils.helpers module<a class="headerlink" href="#module-pyemu.utils.helpers" title="Permalink to this headline">¶</a></h2>
<p>module with high-level functions to help
perform complex tasks</p>
<dl class="function">
<dt id="pyemu.utils.helpers.remove_readonly">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">remove_readonly</code><span class="sig-paren">(</span><em>func</em>, <em>path</em>, <em>excinfo</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#remove_readonly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.remove_readonly" title="Permalink to this definition">¶</a></dt>
<dd><p>remove readonly dirs, apparently only a windows issue
add to all rmtree calls: shutil.rmtree(<a href="#id1"><span class="problematic" id="id2">*</span></a>,onerror=remove_readonly), wk</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>func</strong> (<em>object</em>) – func</li>
<li><strong>path</strong> (<em>str</em>) – path</li>
<li><strong>excinfo</strong> (<em>object</em>) – info</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.run">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">run</code><span class="sig-paren">(</span><em>cmd_str</em>, <em>cwd='.'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.run" title="Permalink to this definition">¶</a></dt>
<dd><p>an OS agnostic function to execute command</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cmd_str</strong> (<em>str</em>) – the str to execute with os.system()</li>
<li><strong>cwd</strong> (<em>str</em>) – the directory to execute the command in</li>
<li><strong>verbose</strong> (<em>bool</em>) – flag to echo to stdout complete cmd str</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>uses platform to detect OS and adds .exe or ./ as appropriate</p>
<p class="last">for Windows, if os.system returns non-zero, raises exception</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pyemu.helpers.run(&quot;pestpp</span> <span class="pre">pest.pst&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.geostatistical_draws">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">geostatistical_draws</code><span class="sig-paren">(</span><em>pst</em>, <em>struct_dict</em>, <em>num_reals=100</em>, <em>sigma_range=4</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#geostatistical_draws"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.geostatistical_draws" title="Permalink to this definition">¶</a></dt>
<dd><p>a helper function to construct a parameter ensenble from a full prior covariance matrix
implied by the geostatistical structure(s) in struct_dict.  This function is much more efficient
for problems with lots of pars (&gt;200K).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file (or the name of control file)</li>
<li><strong>struct_dict</strong> (<em>dict</em>) – a python dict of GeoStruct (or structure file), and list of pp tpl files pairs
If the values in the dict are pd.DataFrames, then they must have an
‘x’,’y’, and ‘parnme’ column.  If the filename ends in ‘.csv’,
then a pd.DataFrame is loaded, otherwise a pilot points file is loaded.</li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to draw.  Default is 100</li>
<li><strong>sigma_range</strong> (<em>float</em>) – a float representing the number of standard deviations implied by parameter bounds.
Default is 4.0, which implies 95% confidence parameter bounds.</li>
<li><strong>verbose</strong> (<em>bool</em>) – flag for stdout.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>par_ens</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.ParameterEnsemble</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pst</span> <span class="pre">=</span> <span class="pre">pyemu.Pst(&quot;pest.pst&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;sd</span> <span class="pre">=</span> <span class="pre">{&quot;struct.dat&quot;:[&quot;hkpp.dat.tpl&quot;,&quot;vka.dat.tpl&quot;]}</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pe</span> <span class="pre">=</span> <span class="pre">pyemu.helpers.geostatistical_draws(pst,struct_dict=sd,num_reals=100)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pe.to_csv(&quot;par_ensemble.csv&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.pilotpoint_prior_builder">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">pilotpoint_prior_builder</code><span class="sig-paren">(</span><em>pst</em>, <em>struct_dict</em>, <em>sigma_range=4</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#pilotpoint_prior_builder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.pilotpoint_prior_builder" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.sparse_geostatistical_prior_builder">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">sparse_geostatistical_prior_builder</code><span class="sig-paren">(</span><em>pst</em>, <em>struct_dict</em>, <em>sigma_range=4</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#sparse_geostatistical_prior_builder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.sparse_geostatistical_prior_builder" title="Permalink to this definition">¶</a></dt>
<dd><p>a helper function to construct a full prior covariance matrix using
a mixture of geostastical structures and parameter bounds information.
The covariance of parameters associated with geostatistical structures is defined
as a mixture of GeoStruct and bounds.  That is, the GeoStruct is used to construct a
pyemu.Cov, then the entire pyemu.Cov is scaled by the uncertainty implied by the bounds and
sigma_range. Sounds complicated…</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file (or the name of control file)</li>
<li><strong>struct_dict</strong> (<em>dict</em>) – a python dict of GeoStruct (or structure file), and list of pp tpl files pairs
If the values in the dict are pd.DataFrames, then they must have an
‘x’,’y’, and ‘parnme’ column.  If the filename ends in ‘.csv’,
then a pd.DataFrame is loaded, otherwise a pilot points file is loaded.</li>
<li><strong>sigma_range</strong> (<em>float</em>) – a float representing the number of standard deviations implied by parameter bounds.
Default is 4.0, which implies 95% confidence parameter bounds.</li>
<li><strong>verbose</strong> (<em>bool</em>) – flag for stdout.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Cov</strong> – a sparse covariance matrix that includes all adjustable parameters in the control
file.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.SparseMatrix</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pst</span> <span class="pre">=</span> <span class="pre">pyemu.Pst(&quot;pest.pst&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;sd</span> <span class="pre">=</span> <span class="pre">{&quot;struct.dat&quot;:[&quot;hkpp.dat.tpl&quot;,&quot;vka.dat.tpl&quot;]}</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;cov</span> <span class="pre">=</span> <span class="pre">pyemu.helpers.sparse_geostatistical_prior_builder(pst,struct_dict=sd)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;cov.to_coo(&quot;prior.jcb&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.geostatistical_prior_builder">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">geostatistical_prior_builder</code><span class="sig-paren">(</span><em>pst</em>, <em>struct_dict</em>, <em>sigma_range=4</em>, <em>par_knowledge_dict=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#geostatistical_prior_builder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.geostatistical_prior_builder" title="Permalink to this definition">¶</a></dt>
<dd><p>a helper function to construct a full prior covariance matrix using
a mixture of geostastical structures and parameter bounds information.
The covariance of parameters associated with geostatistical structures is defined
as a mixture of GeoStruct and bounds.  That is, the GeoStruct is used to construct a
pyemu.Cov, then the entire pyemu.Cov is scaled by the uncertainty implied by the bounds and
sigma_range. Sounds complicated…</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file (or the name of control file)</li>
<li><strong>struct_dict</strong> (<em>dict</em>) – a python dict of GeoStruct (or structure file), and list of pp tpl files pairs
If the values in the dict are pd.DataFrames, then they must have an
‘x’,’y’, and ‘parnme’ column.  If the filename ends in ‘.csv’,
then a pd.DataFrame is loaded, otherwise a pilot points file is loaded.</li>
<li><strong>sigma_range</strong> (<em>float</em>) – a float representing the number of standard deviations implied by parameter bounds.
Default is 4.0, which implies 95% confidence parameter bounds.</li>
<li><strong>par_knowledge_dict</strong> (<em>dict</em>) – used to condition on existing knowledge about parameters.  This functionality is
currently in dev - don’t use it.</li>
<li><strong>verbose</strong> (<em>bool</em>) – stdout flag</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Cov</strong> – a covariance matrix that includes all adjustable parameters in the control
file.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.Cov</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pst</span> <span class="pre">=</span> <span class="pre">pyemu.Pst(&quot;pest.pst&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;sd</span> <span class="pre">=</span> <span class="pre">{&quot;struct.dat&quot;:[&quot;hkpp.dat.tpl&quot;,&quot;vka.dat.tpl&quot;]}</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;cov</span> <span class="pre">=</span> <span class="pre">pyemu.helpers.geostatistical_prior_builder(pst,struct_dict=sd)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;cov.to_ascii(&quot;prior.cov&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.condition_on_par_knowledge">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">condition_on_par_knowledge</code><span class="sig-paren">(</span><em>cov</em>, <em>par_knowledge_dict</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#condition_on_par_knowledge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.condition_on_par_knowledge" title="Permalink to this definition">¶</a></dt>
<dd><p>experimental function to include conditional prior information
for one or more parameters in a full covariance matrix</p>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.kl_setup">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">kl_setup</code><span class="sig-paren">(</span><em>num_eig</em>, <em>sr</em>, <em>struct</em>, <em>prefixes</em>, <em>factors_file='kl_factors.dat'</em>, <em>islog=True</em>, <em>basis_file=None</em>, <em>tpl_dir='.'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#kl_setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.kl_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>setup a karhuenen-Loeve based parameterization for a given
geostatistical structure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_eig</strong> (<em>int</em>) – number of basis vectors to retain in the reduced basis</li>
<li><strong>sr</strong> (<em>flopy.reference.SpatialReference</em>) – </li>
<li><strong>struct</strong> (<em>str</em><em> or </em><em>pyemu.geostats.Geostruct</em>) – geostatistical structure (or file containing one)</li>
<li><strong>array_dict</strong> (<em>dict</em>) – a dict of arrays to setup as KL-based parameters.  The key becomes the
parameter name prefix. The total number of parameters is
len(array_dict) * num_eig</li>
<li><strong>basis_file</strong> (<em>str</em>) – the name of the PEST-format binary file where the reduced basis will be saved</li>
<li><strong>tpl_file</strong> (<em>str</em>) – the name of the template file to make.  The template
file is a csv file with the parameter names, the
original factor values,and the template entries.
The original values can be used to set the parval1
entries in the control file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>back_array_dict</strong> – a dictionary of back transformed arrays.  This is useful to see
how much “smoothing” is taking place compared to the original
arrays.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">requires flopy</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">flopy</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;m</span> <span class="pre">=</span> <span class="pre">flopy.modflow.Modflow.load(&quot;mymodel.nam&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;a_dict</span> <span class="pre">=</span> <span class="pre">{&quot;hk&quot;:m.lpf.hk[0].array}</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;ba_dict</span> <span class="pre">=</span> <span class="pre">pyemu.helpers.kl_setup(10,m.sr,&quot;struct.dat&quot;,a_dict)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.eigen_basis_to_factor_file">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">eigen_basis_to_factor_file</code><span class="sig-paren">(</span><em>nrow</em>, <em>ncol</em>, <em>basis</em>, <em>factors_file</em>, <em>islog=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#eigen_basis_to_factor_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.eigen_basis_to_factor_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.kl_apply">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">kl_apply</code><span class="sig-paren">(</span><em>par_file</em>, <em>basis_file</em>, <em>par_to_file_dict</em>, <em>arr_shape</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#kl_apply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.kl_apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a KL parameterization transform from basis factors to model
input arrays.  Companion function to kl_setup()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>par_file</strong> (<em>str</em>) – the csv file to get factor values from.  Must contain
the following columns: name, new_val, org_val</li>
<li><strong>basis_file</strong> (<em>str</em>) – the binary file that contains the reduced basis</li>
<li><strong>par_to_file_dict</strong> (<em>dict</em>) – a mapping from KL parameter prefixes to array file names.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is the companion function to kl_setup.</p>
<p class="last">This function should be called during the forward run</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pyemu.helpers.kl_apply(&quot;kl.dat&quot;,&quot;basis.dat&quot;,{&quot;hk&quot;:&quot;hk_layer_1.dat&quot;,(100,100))</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.zero_order_tikhonov">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">zero_order_tikhonov</code><span class="sig-paren">(</span><em>pst</em>, <em>parbounds=True</em>, <em>par_groups=None</em>, <em>reset=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#zero_order_tikhonov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.zero_order_tikhonov" title="Permalink to this definition">¶</a></dt>
<dd><p>setup preferred-value regularization</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – the control file instance</li>
<li><strong>parbounds</strong> (<em>bool</em>) – flag to weight the prior information equations according
to parameter bound width - approx the KL transform. Default
is True</li>
<li><strong>par_groups</strong> (<em>list</em>) – parameter groups to build PI equations for.  If None, all
adjustable parameters are used. Default is None</li>
<li><strong>reset</strong> (<em>bool</em>) – flag to reset the prior_information attribute of the pst
instance.  Default is True</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pst</span> <span class="pre">=</span> <span class="pre">pyemu.Pst(&quot;pest.pst&quot;)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pyemu.helpers.zero_order_tikhonov(pst)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.regweight_from_parbound">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">regweight_from_parbound</code><span class="sig-paren">(</span><em>pst</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#regweight_from_parbound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.regweight_from_parbound" title="Permalink to this definition">¶</a></dt>
<dd><p>sets regularization weights from parameter bounds
which approximates the KL expansion.  Called by
zero_order_tikhonov().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pst</strong> (<em>pyemu.Pst</em>) – a control file instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.first_order_pearson_tikhonov">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">first_order_pearson_tikhonov</code><span class="sig-paren">(</span><em>pst</em>, <em>cov</em>, <em>reset=True</em>, <em>abs_drop_tol=0.001</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#first_order_pearson_tikhonov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.first_order_pearson_tikhonov" title="Permalink to this definition">¶</a></dt>
<dd><p>setup preferred-difference regularization from a covariance matrix.
The weights on the prior information equations are the Pearson
correlation coefficients implied by covariance matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – pst instance</li>
<li><strong>cov</strong> (<em>pyemu.Cov</em>) – covariance matrix instance</li>
<li><strong>reset</strong> (<em>bool</em>) – drop all other pi equations.  If False, append to
existing pi equations</li>
<li><strong>abs_drop_tol</strong> (<em>float</em>) – tolerance to control how many pi equations are written.
If the Pearson C is less than abs_drop_tol, the prior information
equation will not be included in the control file</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pst</span> <span class="pre">=</span> <span class="pre">pyemu.Pst(&quot;pest.pst&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;cov</span> <span class="pre">=</span> <span class="pre">pyemu.Cov.from_ascii(&quot;prior.cov&quot;)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pyemu.helpers.first_order_pearson_tikhonov(pst,cov,abs_drop_tol=0.25)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.simple_tpl_from_pars">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">simple_tpl_from_pars</code><span class="sig-paren">(</span><em>parnames</em>, <em>tplfilename='model.input.tpl'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#simple_tpl_from_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.simple_tpl_from_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a template file just assuming a list of parameter names the values of which should be
listed in order in a model input file
:param parnames: list of names from which to make a template file
:param tplfilename: filename for TPL file (default: model.input.tpl)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">writes a file &lt;tplfilename&gt; with each parameter name on a line</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.simple_ins_from_obs">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">simple_ins_from_obs</code><span class="sig-paren">(</span><em>obsnames</em>, <em>insfilename='model.output.ins'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#simple_ins_from_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.simple_ins_from_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>writes an instruction file that assumes wanting to read the values names in obsnames in order
one per line from a model output file
:param obsnames: list of obsnames to read in
:param insfilename: filename for INS file (default: model.output.ins)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">writes a file &lt;insfilename&gt; with each observation read off a line</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.pst_from_parnames_obsnames">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">pst_from_parnames_obsnames</code><span class="sig-paren">(</span><em>parnames</em>, <em>obsnames</em>, <em>tplfilename='model.input.tpl'</em>, <em>insfilename='model.output.ins'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#pst_from_parnames_obsnames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.pst_from_parnames_obsnames" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Pst object from a list of parameter names and a list of observation names.
Default values are provided for the TPL and INS
:param parnames: list of names from which to make a template file
:param obsnames: list of obsnames to read in
:param tplfilename: filename for TPL file (default: model.input.tpl)
:param insfilename: filename for INS file (default: model.output.ins)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Pst object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.start_slaves">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">start_slaves</code><span class="sig-paren">(</span><em>slave_dir</em>, <em>exe_rel_path</em>, <em>pst_rel_path</em>, <em>num_slaves=None</em>, <em>slave_root='..'</em>, <em>port=4004</em>, <em>rel_path=None</em>, <em>local=True</em>, <em>cleanup=True</em>, <em>master_dir=None</em>, <em>verbose=False</em>, <em>silent_master=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#start_slaves"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.start_slaves" title="Permalink to this definition">¶</a></dt>
<dd><p>start a group of pest(++) slaves on the local machine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>slave_dir</strong> (<em>str</em>) – the path to a complete set of input files</li>
<li><strong>exe_rel_path</strong> (<em>str</em>) – the relative path to the pest(++) executable from within the slave_dir</li>
<li><strong>pst_rel_path</strong> (<em>str</em>) – the relative path to the pst file from within the slave_dir</li>
<li><strong>num_slaves</strong> (<em>int</em>) – number of slaves to start. defaults to number of cores</li>
<li><strong>slave_root</strong> (<em>str</em>) – the root to make the new slave directories in</li>
<li><strong>rel_path</strong> (<em>str</em>) – the relative path to where pest(++) should be run from within the
slave_dir, defaults to the uppermost level of the slave dir</li>
<li><strong>local</strong> (<em>bool</em>) – flag for using “localhost” instead of hostname on slave command line</li>
<li><strong>cleanup</strong> (<em>bool</em>) – flag to remove slave directories once processes exit</li>
<li><strong>master_dir</strong> (<em>str</em>) – name of directory for master instance.  If master_dir
exists, then it will be removed.  If master_dir is None,
no master instance will be started</li>
<li><strong>verbose</strong> (<em>bool</em>) – flag to echo useful information to stdout</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if all slaves (and optionally master) exit gracefully, then the slave
dirs will be removed unless cleanup is false</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p>start 10 slaves using the directory “template” as the base case and
also start a master instance in a directory “master”.</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pyemu.helpers.start_slaves(&quot;template&quot;,&quot;pestpp&quot;,&quot;pest.pst&quot;,10,master_dir=&quot;master&quot;)</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.read_pestpp_runstorage">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">read_pestpp_runstorage</code><span class="sig-paren">(</span><em>filename</em>, <em>irun=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#read_pestpp_runstorage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.read_pestpp_runstorage" title="Permalink to this definition">¶</a></dt>
<dd><p>read pars and obs from a specific run in a pest++ serialized run storage file into
pandas.DataFrame(s)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) – the name of the run storage file</li>
<li><strong>irun</strong> (<em>int</em>) – the run id to process.  Default is 0</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>par_df</strong> (<em>pandas.DataFrame</em>) – parameter information</li>
<li><strong>obs_df</strong> (<em>pandas.DataFrame</em>) – observation information</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.jco_from_pestpp_runstorage">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">jco_from_pestpp_runstorage</code><span class="sig-paren">(</span><em>rnj_filename</em>, <em>pst_filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#jco_from_pestpp_runstorage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.jco_from_pestpp_runstorage" title="Permalink to this definition">¶</a></dt>
<dd><p>read pars and obs from a pest++ serialized run storage file (e.g., .rnj) and return
pyemu.Jco.  This can then be passed to Jco.to_binary or Jco.to_coo, etc., to write jco file
in a subsequent step to avoid memory resource issues associated with very large problems.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rnj_filename</strong> (<em>str</em>) – the name of the run storage file</li>
<li><strong>pst_filename</strong> (<em>str</em>) – the name of the pst file</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>jco_cols</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.Jco</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>TODO:
0. Check rnj file contains transformed par vals (i.e., in model input space)
1. Currently only returns pyemu.Jco; doesn’t write jco file due to memory issues</p>
<blockquote>
<div>associated with very large problems</div></blockquote>
<ol class="arabic simple" start="3">
<li>Compare rnj and jco from Freyberg problem in autotests</li>
</ol>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.parse_dir_for_io_files">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">parse_dir_for_io_files</code><span class="sig-paren">(</span><em>d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#parse_dir_for_io_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.parse_dir_for_io_files" title="Permalink to this definition">¶</a></dt>
<dd><p>a helper function to find template/input file pairs and
instruction file/output file pairs.  the return values from this
function can be passed straight to pyemu.Pst.from_io_files() classmethod
constructor. Assumes the template file names are &lt;input_file&gt;.tpl and
instruction file names are &lt;output_file&gt;.ins.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>d</strong> (<em>str</em>) – directory to search for interface files</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>tpl_files</strong> (<em>list</em>) – list of template files in d</li>
<li><strong>in_files</strong> (<em>list</em>) – list of input files in d</li>
<li><strong>ins_files</strong> (<em>list</em>) – list of instruction files in d</li>
<li><strong>out_files</strong> (<em>list</em>) – list of output files in d</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.pst_from_io_files">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">pst_from_io_files</code><span class="sig-paren">(</span><em>tpl_files</em>, <em>in_files</em>, <em>ins_files</em>, <em>out_files</em>, <em>pst_filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#pst_from_io_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.pst_from_io_files" title="Permalink to this definition">¶</a></dt>
<dd><p>generate a Pst instance from the model io files.  If ‘inschek’
is available (either in the current directory or registered
with the system variables) and the model output files are available
, then the observation values in the control file will be set to the
values of the model-simulated equivalents to observations.  This can be
useful for testing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tpl_files</strong> (<em>list</em>) – list of pest template files</li>
<li><strong>in_files</strong> (<em>list</em>) – list of corresponding model input files</li>
<li><strong>ins_files</strong> (<em>list</em>) – list of pest instruction files</li>
<li><strong>out_files</strong> (<em>list</em>) – list of corresponding model output files</li>
<li><strong>pst_filename</strong> (<em>str</em>) – name of file to write the control file to.  If None,
control file is not written.  Default is None</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pst</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pyemu.Pst</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p>this will construct a new Pst instance from template and instruction files
found in the current directory, assuming that the naming convention follows
that listed in parse_dir_for_io_files()</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pst</span> <span class="pre">=</span> <span class="pre">pyemu.helpers.pst_from_io_files(*pyemu.helpers.parse_dir_for_io_files('.'))</span></code></p>
</div>
</dd></dl>

<dl class="class">
<dt id="pyemu.utils.helpers.PstFromFlopyModel">
<em class="property">class </em><code class="descclassname">pyemu.utils.helpers.</code><code class="descname">PstFromFlopyModel</code><span class="sig-paren">(</span><em>model</em>, <em>new_model_ws</em>, <em>org_model_ws=None</em>, <em>pp_props=[]</em>, <em>const_props=[]</em>, <em>temporal_bc_props=[]</em>, <em>grid_props=[]</em>, <em>grid_geostruct=None</em>, <em>pp_space=None</em>, <em>zone_props=[]</em>, <em>pp_geostruct=None</em>, <em>par_bounds_dict=None</em>, <em>sfr_pars=False</em>, <em>temporal_bc_geostruct=None</em>, <em>remove_existing=False</em>, <em>k_zone_dict=None</em>, <em>mflist_waterbudget=True</em>, <em>mfhyd=True</em>, <em>hds_kperk=[]</em>, <em>use_pp_zones=False</em>, <em>obssim_smp_pairs=None</em>, <em>external_tpl_in_pairs=None</em>, <em>external_ins_out_pairs=None</em>, <em>extra_pre_cmds=None</em>, <em>extra_model_cmds=None</em>, <em>extra_post_cmds=None</em>, <em>redirect_forward_output=True</em>, <em>tmp_files=None</em>, <em>model_exe_name=None</em>, <em>build_prior=True</em>, <em>sfr_obs=False</em>, <em>all_wells=False</em>, <em>bc_props=[]</em>, <em>spatial_bc_props=[]</em>, <em>spatial_bc_geostruct=None</em>, <em>hfb_pars=False</em>, <em>kl_props=None</em>, <em>kl_num_eig=100</em>, <em>kl_geostruct=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="docutils">
<dt>a monster helper class to setup multiplier parameters for an</dt>
<dd>existing MODFLOW model.  does all kinds of coolness like building a
meaningful prior, assigning somewhat meaningful parameter groups and
bounds, writes a forward_run.py script with all the calls need to
implement multiplier parameters, run MODFLOW and post-process.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>flopy.mbase</em>) – a loaded flopy model instance. If model is an str, it is treated as a
MODFLOW nam file (requires org_model_ws)</li>
<li><strong>new_model_ws</strong> (<em>str</em>) – a directory where the new version of MODFLOW input files and PEST(++)
files will be written</li>
<li><strong>org_model_ws</strong> (<em>str</em>) – directory to existing MODFLOW model files.  Required if model argument
is an str.  Default is None</li>
<li><strong>pp_props</strong> (<em>list</em>) – pilot point multiplier parameters for grid-based properties.
A nested list of grid-scale model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices.  For example, [“lpf.hk”,[0,1,2,]] would setup pilot point multiplier
parameters for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3.  For time-varying properties (e.g. recharge), the
iterable is for zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup pilot point multiplier parameters for recharge for stress
period 1,5,11,and 16.</li>
<li><strong>const_props</strong> (<em>list</em>) – constant (uniform) multiplier parameters for grid-based properties.
A nested list of grid-scale model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices.  For example, [“lpf.hk”,[0,1,2,]] would setup constant (uniform) multiplier
parameters for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3.  For time-varying properties (e.g. recharge), the
iterable is for zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup constant (uniform) multiplier parameters for recharge for stress
period 1,5,11,and 16.</li>
<li><strong>temporal_bc_props</strong> (<em>list</em>) – boundary condition stress-period level multiplier parameters.
A nested list of boundary condition elements to parameterize using
name, iterable pairs.  The iterable is zero-based stress-period indices.
For example, to setup multipliers for WEL flux and for RIV conductance,
bc_props = [[“wel.flux”,[0,1,2]],[“riv.cond”,None]] would setup
multiplier parameters for well flux for stress periods 1,2 and 3 and
would setup one single river conductance multiplier parameter that is applied
to all stress periods</li>
<li><strong>spatial_bc_props</strong> (<em>list</em>) – boundary condition spatial multiplier parameters.
A nested list of boundary condition elements to parameterize using
names (e.g. [[“riv.cond”,0],[“wel.flux”,1] to setup up cell-based parameters for
each boundary condition element listed.  These multipler parameters are applied across
all stress periods.  For this to work, there must be the same number of entries
for all stress periods.  If more than one BC of the same type is in a single
cell, only one parameter is used to multiply all BCs in the same cell.</li>
<li><strong>grid_props</strong> (<em>list</em>) – grid-based (every active model cell) multiplier parameters.
A nested list of grid-scale model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices (e.g., [“lpf.hk”,[0,1,2,]] would setup a multiplier
parameter for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3 in every active model cell).  For time-varying properties (e.g. recharge), the
iterable is for zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup grid-based multiplier parameters in every active model cell
for recharge for stress period 1,5,11,and 16.</li>
<li><strong>grid_geostruct</strong> (<em>pyemu.geostats.GeoStruct</em>) – the geostatistical structure to build the prior parameter covariance matrix
elements for grid-based parameters.  If None, a generic GeoStruct is created
using an “a” parameter that is 10 times the max cell size.  Default is None</li>
<li><strong>pp_space</strong> (<em>int</em>) – number of grid cells between pilot points.  If None, use the default
in pyemu.pp_utils.setup_pilot_points_grid.  Default is None</li>
<li><strong>zone_props</strong> (<em>list</em>) – zone-based multiplier parameters.
A nested list of grid-scale model properties to parameterize using
name, iterable pairs.  For 3D properties, the iterable is zero-based
layer indices (e.g., [“lpf.hk”,[0,1,2,]] would setup a multiplier
parameter for layer property file horizontal hydraulic conductivity for model
layers 1,2, and 3 for unique zone values in the ibound array.
For time-varying properties (e.g. recharge), the iterable is for
zero-based stress period indices.  For example, [“rch.rech”,[0,4,10,15]]
would setup zone-based multiplier parameters for recharge for stress
period 1,5,11,and 16.</li>
<li><strong>pp_geostruct</strong> (<em>pyemu.geostats.GeoStruct</em>) – the geostatistical structure to use for building the prior parameter
covariance matrix for pilot point parameters.  If None, a generic
GeoStruct is created using pp_space and grid-spacing information.
Default is None</li>
<li><strong>par_bounds_dict</strong> (<em>dict</em>) – a dictionary of model property/boundary condition name, upper-lower bound pairs.
For example, par_bounds_dict = {“hk”:[0.01,100.0],”flux”:[0.5,2.0]} would
set the bounds for horizontal hydraulic conductivity to
0.001 and 100.0 and set the bounds for flux parameters to 0.5 and
2.0.  For parameters not found in par_bounds_dict,
pyemu.helpers.wildass_guess_par_bounds_dict is
used to set somewhat meaningful bounds.  Default is None</li>
<li><strong>temporal_bc_geostruct</strong> (<em>pyemu.geostats.GeoStruct</em>) – the geostastical struture to build the prior parameter covariance matrix
for time-varying boundary condition multiplier parameters.  This GeoStruct
express the time correlation so that the ‘a’ parameter is the length of
time that boundary condition multiplier parameters are correlated across.
If None, then a generic GeoStruct is created that uses an ‘a’ parameter
of 3 stress periods.  Default is None</li>
<li><strong>spatial_bc_geostruct</strong> (<em>pyemu.geostats.GeoStruct</em>) – the geostastical struture to build the prior parameter covariance matrix
for spatially-varying boundary condition multiplier parameters.
If None, a generic GeoStruct is created using an “a” parameter that
is 10 times the max cell size.  Default is None.</li>
<li><strong>remove_existing</strong> (<em>bool</em>) – a flag to remove an existing new_model_ws directory.  If False and
new_model_ws exists, an exception is raised.  If True and new_model_ws
exists, the directory is destroyed - user beware! Default is False.</li>
<li><strong>k_zone_dict</strong> (<em>dict</em>) – a dictionary of zero-based layer index, zone array pairs.  Used to
override using ibound zones for zone-based parameterization.  If None,
use ibound values greater than zero as zones.</li>
<li><strong>use_pp_zones</strong> (<em>bool</em>) – a flag to use ibound zones (or k_zone_dict, see above) as pilot
point zones.  If False, ibound values greater than zero are treated as
a single zone for pilot points.  Default is False</li>
<li><strong>obssim_smp_pairs</strong> (<em>list</em>) – a list of observed-simulated PEST-type SMP file pairs to get observations
from and include in the control file.  Default is []</li>
<li><strong>external_tpl_in_pairs</strong> (<em>list</em>) – a list of existing template file, model input file pairs to parse parameters
from and include in the control file.  Default is []</li>
<li><strong>external_ins_out_pairs</strong> (<em>list</em>) – a list of existing instruction file, model output file pairs to parse
observations from and include in the control file.  Default is []</li>
<li><strong>extra_pre_cmds</strong> (<em>list</em>) – a list of preprocessing commands to add to the forward_run.py script
commands are executed with os.system() within forward_run.py. Default
is None.</li>
<li><strong>redirect_forward_output</strong> (<em>bool</em>) – flag for whether to redirect forward model output to text files (True) or
allow model output to be directed to the screen (False)
Default is True</li>
<li><strong>extra_post_cmds</strong> (<em>list</em>) – a list of post-processing commands to add to the forward_run.py script.
Commands are executed with os.system() within forward_run.py.
Default is None.</li>
<li><strong>tmp_files</strong> (<em>list</em>) – a list of temporary files that should be removed at the start of the forward
run script.  Default is [].</li>
<li><strong>model_exe_name</strong> (<em>str</em>) – binary name to run modflow.  If None, a default from flopy is used,
which is dangerous because of the non-standard binary names
(e.g. MODFLOW-NWT_x64, MODFLOWNWT, mfnwt, etc). Default is None.</li>
<li><strong>build_prior</strong> (<em>bool</em>) – flag to build prior covariance matrix. Default is True</li>
<li><strong>sfr_obs</strong> (<em>bool</em>) – flag to include observations of flow and aquifer exchange from
the sfr ASCII output file</li>
<li><strong>all_wells</strong> (<em>bool</em><em> [</em><em>DEPRECATED - now use spatial_bc_pars</em><em>]</em>) – </li>
<li><strong>hfb_pars</strong> (<em>bool</em>) – add HFB parameters.  uses pyemu.gw_utils.write_hfb_template().  the resulting
HFB pars have parval1 equal to the values in the original file and use the
spatial_bc_geostruct to build geostatistical covariates between parameters</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>PstFromFlopyModel</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pyemu.utils.helpers.PstFromFlopyModel" title="pyemu.utils.helpers.PstFromFlopyModel">PstFromFlopyModel</a></p>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.pst">
<code class="descname">pst</code><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.pst" title="Permalink to this definition">¶</a></dt>
<dd><p><em>pyemu.Pst</em></p>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">works a lot better if TEMPCHEK, INSCHEK and PESTCHEK are available in the
system path variable</p>
</div>
<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_sfr_obs">
<code class="descname">setup_sfr_obs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_sfr_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_sfr_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup sfr ASCII observations</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_sfr_pars">
<code class="descname">setup_sfr_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_sfr_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_sfr_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>setup multiplier parameters for sfr segment data
Adding support for reachinput (and isfropt = 1)</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_hfb_pars">
<code class="descname">setup_hfb_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_hfb_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_hfb_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>setup non-mult parameters for hfb (yuck!)</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_mult_dirs">
<code class="descname">setup_mult_dirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_mult_dirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_mult_dirs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup the directories to use for multiplier parameterization.  Directories
are make within the PstFromFlopyModel.m.model_ws directory</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_model">
<code class="descname">setup_model</code><span class="sig-paren">(</span><em>model</em>, <em>org_model_ws</em>, <em>new_model_ws</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_model" title="Permalink to this definition">¶</a></dt>
<dd><p>setup the flopy.mbase instance for use with multipler parameters.
Changes model_ws, sets external_path and writes new MODFLOW input
files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>flopy.mbase</em>) – flopy model instance</li>
<li><strong>org_model_ws</strong> (<em>str</em>) – the orginal model working space</li>
<li><strong>new_model_ws</strong> (<em>str</em>) – the new model working space</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.get_count">
<code class="descname">get_count</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.get_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.get_count" title="Permalink to this definition">¶</a></dt>
<dd><p>get the latest counter for a certain parameter type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – the parameter type</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>count</strong> – the latest count for a parameter type</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">calling this function increments the counter for the passed
parameter type</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.prep_mlt_arrays">
<code class="descname">prep_mlt_arrays</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.prep_mlt_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.prep_mlt_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare multipler arrays.  Copies existing model input arrays and
writes generic (ones) multiplier arrays</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.write_u2d">
<code class="descname">write_u2d</code><span class="sig-paren">(</span><em>u2d</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.write_u2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.write_u2d" title="Permalink to this definition">¶</a></dt>
<dd><p>write a flopy.utils.Util2D instance to an ASCII text file using the
Util2D filename</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>u2d</strong> (<em>flopy.utils.Util2D</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>filename</strong> – the name of the file written (without path)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.write_const_tpl">
<code class="descname">write_const_tpl</code><span class="sig-paren">(</span><em>name</em>, <em>tpl_file</em>, <em>zn_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.write_const_tpl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.write_const_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file a for a constant (uniform) multiplier parameter</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) – the base parameter name</li>
<li><strong>tpl_file</strong> (<em>str</em>) – the template file to write</li>
<li><strong>zn_array</strong> (<em>numpy.ndarray</em>) – an array used to skip inactive cells</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with parameter information</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.write_grid_tpl">
<code class="descname">write_grid_tpl</code><span class="sig-paren">(</span><em>name</em>, <em>tpl_file</em>, <em>zn_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.write_grid_tpl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.write_grid_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file a for grid-based multiplier parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) – the base parameter name</li>
<li><strong>tpl_file</strong> (<em>str</em>) – the template file to write</li>
<li><strong>zn_array</strong> (<em>numpy.ndarray</em>) – an array used to skip inactive cells</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with parameter information</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.write_zone_tpl">
<em class="property">static </em><code class="descname">write_zone_tpl</code><span class="sig-paren">(</span><em>model</em>, <em>name</em>, <em>tpl_file</em>, <em>zn_array</em>, <em>zn_suffix</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.write_zone_tpl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.write_zone_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file a for zone-based multiplier parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>flopy model object</em>) – model from which to obtain workspace information, nrow, and ncol</li>
<li><strong>name</strong> (<em>str</em>) – the base parameter name</li>
<li><strong>tpl_file</strong> (<em>str</em>) – the template file to write</li>
<li><strong>zn_array</strong> (<em>numpy.ndarray</em>) – an array used to skip inactive cells</li>
<li><strong>logger</strong> (<em>a logger object</em>) – optional - a logger object to document errors, etc.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – a dataframe with parameter information</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.grid_prep">
<code class="descname">grid_prep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.grid_prep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.grid_prep" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare grid-based parameterizations</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.pp_prep">
<code class="descname">pp_prep</code><span class="sig-paren">(</span><em>mlt_df</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.pp_prep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.pp_prep" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare pilot point based parameterizations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mlt_df</strong> (<em>pandas.DataFrame</em>) – a dataframe with multiplier array information</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">calls pyemu.pp_utils.setup_pilot_points_grid()</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.kl_prep">
<code class="descname">kl_prep</code><span class="sig-paren">(</span><em>mlt_df</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.kl_prep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.kl_prep" title="Permalink to this definition">¶</a></dt>
<dd><p>prepare KL based parameterizations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mlt_df</strong> (<em>pandas.DataFrame</em>) – a dataframe with multiplier array information</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">calls pyemu.helpers.setup_kl()</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_array_pars">
<code class="descname">setup_array_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_array_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_array_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>main entry point for setting up array multipler parameters</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_observations">
<code class="descname">setup_observations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_observations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>main entry point for setting up observations</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>num_reals=100</em>, <em>sigma_range=6</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>draw like a boss!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to generate. Default is 100</li>
<li><strong>sigma_range</strong> (<em>float</em>) – number of standard deviations represented by the parameter bounds.  Default
is 6.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>cov</strong> (<em>pyemu.Cov</em>)</li>
<li><em>a full covariance matrix</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.build_prior">
<code class="descname">build_prior</code><span class="sig-paren">(</span><em>fmt='ascii'</em>, <em>filename=None</em>, <em>droptol=None</em>, <em>chunk=None</em>, <em>sparse=False</em>, <em>sigma_range=6</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.build_prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.build_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>build a prior parameter covariance matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fmt</strong> (<em>str</em>) – the format to save the cov matrix.  Options are “ascii”,”binary”,”uncfile”, “coo”.
default is “ascii”</li>
<li><strong>filename</strong> (<em>str</em>) – the filename to save the prior cov matrix to.  If None, the name is formed using
model nam_file name.  Default is None.</li>
<li><strong>droptol</strong> (<em>float</em>) – tolerance for dropping near-zero values when writing compressed binary.
Default is None</li>
<li><strong>chunk</strong> (<em>int</em>) – chunk size to write in a single pass - for binary only</li>
<li><strong>sparse</strong> (<em>bool</em>) – flag to build a pyemu.SparseMatrix format cov matrix.  Default is False</li>
<li><strong>sigma_range</strong> (<em>float</em>) – number of standard deviations represented by the parameter bounds.  Default
is 6.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>cov</strong> (<em>pyemu.Cov</em>)</li>
<li><em>a full covariance matrix</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.build_pst">
<code class="descname">build_pst</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.build_pst"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.build_pst" title="Permalink to this definition">¶</a></dt>
<dd><p>build the pest control file using the parameterizations and
observations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) – the filename to save the pst to.  If None, the name if formed from
the model namfile name.  Default is None.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>calls pyemu.Pst.from_io_files</p>
<p class="last">calls PESTCHEK</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.add_external">
<code class="descname">add_external</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.add_external"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.add_external" title="Permalink to this definition">¶</a></dt>
<dd><p>add external (existing) template files and instrution files to the
Pst instance</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.write_forward_run">
<code class="descname">write_forward_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.write_forward_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.write_forward_run" title="Permalink to this definition">¶</a></dt>
<dd><p>write the forward run script forward_run.py</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.parse_k">
<code class="descname">parse_k</code><span class="sig-paren">(</span><em>k</em>, <em>vals</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.parse_k"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.parse_k" title="Permalink to this definition">¶</a></dt>
<dd><p>parse the iterable from a property or boundary condition argument</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>k</strong> (<em>int</em><em> or </em><em>iterable int</em>) – the iterable</li>
<li><strong>vals</strong> (<em>iterable of ints</em>) – the acceptable values that k may contain</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>k_vals</strong> – parsed k values</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">iterable of int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.parse_pakattr">
<code class="descname">parse_pakattr</code><span class="sig-paren">(</span><em>pakattr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.parse_pakattr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.parse_pakattr" title="Permalink to this definition">¶</a></dt>
<dd><p>parse package-iterable pairs from a property or boundary condition
argument</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pakattr</strong> (<em>iterable len 2</em>) – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>pak</strong> (<em>flopy.PakBase</em>) – the flopy package from the model instance</li>
<li><strong>attr</strong> (<em>(varies)</em>) – the flopy attribute from pak.  Could be Util2D, Util3D,
Transient2D, or MfList</li>
<li><strong>attrname</strong> (<em>(str)</em>) – the name of the attribute for MfList type.  Only returned if
attr is MfList.  For example, if attr is MfList and pak is
flopy.modflow.ModflowWel, then attrname can only be “flux”</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_bc_pars">
<code class="descname">setup_bc_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_bc_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_bc_pars" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_temporal_bc_pars">
<code class="descname">setup_temporal_bc_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_temporal_bc_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_temporal_bc_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>main entry point for setting up boundary condition multiplier
parameters</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_spatial_bc_pars">
<code class="descname">setup_spatial_bc_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_spatial_bc_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_spatial_bc_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>helper to setup crazy numbers of well flux multipliers</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.bc_helper">
<code class="descname">bc_helper</code><span class="sig-paren">(</span><em>k</em>, <em>pak</em>, <em>attr</em>, <em>col</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.bc_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.bc_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>helper to setup boundary condition multiplier parameters for a given
k, pak, attr set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>k</strong> (<em>int</em><em> or </em><em>iterable of int</em>) – the zero-based stress period indices</li>
<li><strong>pak</strong> (<em>flopy.PakBase=</em>) – the MODFLOW package</li>
<li><strong>attr</strong> (<em>MfList</em>) – the MfList instance</li>
<li><strong>col</strong> (<em>str</em>) – the column name in the MfList recarray to parameterize</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_hds">
<code class="descname">setup_hds</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_hds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_hds" title="Permalink to this definition">¶</a></dt>
<dd><p>setup modflow head save file observations for given kper (zero-based
stress period index) and k (zero-based layer index) pairs using the
kperk argument.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>this can setup a shit-ton of observations</p>
<p class="last">this is useful for dataworth analyses or for monitoring
water levels as forecasts</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_smp">
<code class="descname">setup_smp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_smp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_smp" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations from PEST-style SMP file pairs</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_hob">
<code class="descname">setup_hob</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_hob"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_hob" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations from the MODFLOW HOB package</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_hyd">
<code class="descname">setup_hyd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_hyd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_hyd" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations from the MODFLOW HYDMOD package</p>
</dd></dl>

<dl class="method">
<dt id="pyemu.utils.helpers.PstFromFlopyModel.setup_water_budget_obs">
<code class="descname">setup_water_budget_obs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#PstFromFlopyModel.setup_water_budget_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.PstFromFlopyModel.setup_water_budget_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>setup observations from the MODFLOW list file for
volume and flux water buget information</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.apply_array_pars">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">apply_array_pars</code><span class="sig-paren">(</span><em>arr_par_file='arr_pars.csv'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#apply_array_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.apply_array_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to apply array-based multipler parameters.  Used to implement
the parameterization constructed by PstFromFlopyModel during a forward run</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arr_par_file</strong> (<em>str</em>) – </li>
<li><strong>to csv file detailing parameter array multipliers</strong> (<em>path</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>“arr_pars.csv” - is written by PstFromFlopy</p>
<p class="last">the function should be added to the forward_run.py script but can be called on any correctly formatted csv</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.apply_bc_pars">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">apply_bc_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#apply_bc_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.apply_bc_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to apply boundary condition multiplier parameters.  Used to implement
the parameterization constructed by PstFromFlopyModel during a forward run</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>requires “bc_pars.csv”</p>
<p class="last">should be added to the forward_run.py script</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.apply_hfb_pars">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">apply_hfb_pars</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#apply_hfb_pars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.apply_hfb_pars" title="Permalink to this definition">¶</a></dt>
<dd><p>a function to apply HFB multiplier parameters.  Used to implement
the parameterization constructed by write_hfb_zone_multipliers_template()</p>
<p>This is to account for the horrible HFB6 format that differs from other BCs making this a special case</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>requires “hfb_pars.csv”</p>
<p class="last">should be added to the forward_run.py script</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.plot_flopy_par_ensemble">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">plot_flopy_par_ensemble</code><span class="sig-paren">(</span><em>pst</em>, <em>pe</em>, <em>num_reals=None</em>, <em>model=None</em>, <em>fig_axes_generator=None</em>, <em>pcolormesh_transform=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#plot_flopy_par_ensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.plot_flopy_par_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>function to plot ensemble of parameter values for a flopy/modflow model.  Assumes
the FlopytoPst helper was used to setup the model and the forward run.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pst</strong> (<em>Pst instance</em>) – </li>
<li><strong>pe</strong> (<em>ParameterEnsemble instance</em>) – </li>
<li><strong>num_reals</strong> (<em>int</em>) – number of realizations to process.  If None, all realizations are processed.
default is None</li>
<li><strong>model</strong> (<em>flopy.mbase</em>) – model instance used for masking inactive areas and also geo-locating plots.  If None,
generic plots are made.  Default is None.</li>
<li><strong>fig_axes_generator</strong> (<em>function</em>) – a function that returns a pyplot.figure and list of pyplot.axes instances for plots.
If None, a generic 8.5inX11in figure with 3 rows and 2 cols is used.</li>
<li><strong>pcolormesh_transform</strong> (<em>cartopy.csr.CRS</em>) – transform to map pcolormesh plot into correct location.  Requires model arg</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Needs “arr_pars.csv” to run</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">add better support for log vs nonlog- currently just logging everything
add support for cartopy basemap and stamen tiles</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.plot_summary_distributions">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">plot_summary_distributions</code><span class="sig-paren">(</span><em>df</em>, <em>ax=None</em>, <em>label_post=False</em>, <em>label_prior=False</em>, <em>subplots=False</em>, <em>figsize=(11</em>, <em>8.5)</em>, <em>pt_color='b'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#plot_summary_distributions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.plot_summary_distributions" title="Permalink to this definition">¶</a></dt>
<dd><p>helper function to plot gaussian distrbutions from prior and posterior
means and standard deviations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> (<em>pandas.DataFrame</em>) – a dataframe and csv file.  Must have columns named:
‘prior_mean’,’prior_stdev’,’post_mean’,’post_stdev’.  If loaded
from a csv file, column 0 is assumed to tbe the index</li>
<li><strong>ax</strong> (<em>matplotlib.pyplot.axis</em>) – If None, and not subplots, then one is created
and all distributions are plotted on a single plot</li>
<li><strong>label_post</strong> (<em>bool</em>) – flag to add text labels to the peak of the posterior</li>
<li><strong>label_prior</strong> (<em>bool</em>) – flag to add text labels to the peak of the prior</li>
<li><strong>subplots</strong> (<em>(</em><em>boolean</em><em>)</em>) – flag to use subplots.  If True, then 6 axes per page
are used and a single prior and posterior is plotted on each</li>
<li><strong>figsize</strong> (<em>tuple</em>) – matplotlib figure size</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>figs</strong> (<em>list</em>) – list of figures</li>
<li><strong>axes</strong> (<em>list</em>) – list of axes</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is useful for demystifying FOSM results</p>
<p class="last">if subplots is False, a single axis is returned</p>
</div>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">matplotlib.pyplot</span> <span class="pre">as</span> <span class="pre">plt</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">pyemu</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;pyemu.helpers.plot_summary_distributions(&quot;pest.par.usum.csv&quot;)</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;plt.show()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.gaussian_distribution">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">gaussian_distribution</code><span class="sig-paren">(</span><em>mean</em>, <em>stdev</em>, <em>num_pts=50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#gaussian_distribution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.gaussian_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>get an x and y numpy.ndarray that spans the +/- 4
standard deviation range of a gaussian distribution with
a given mean and standard deviation. useful for plotting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mean</strong> (<em>float</em>) – the mean of the distribution</li>
<li><strong>stdev</strong> (<em>float</em>) – the standard deviation of the distribution</li>
<li><strong>num_pts</strong> (<em>int</em>) – the number of points in the returned ndarrays.
Default is 50</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>x</strong> (<em>numpy.ndarray</em>) – the x-values of the distribution</li>
<li><strong>y</strong> (<em>numpy.ndarray</em>) – the y-values of the distribution</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.build_jac_test_csv">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">build_jac_test_csv</code><span class="sig-paren">(</span><em>pst</em>, <em>num_steps</em>, <em>par_names=None</em>, <em>forward=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#build_jac_test_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.build_jac_test_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>build a dataframe of jactest inputs for use with sweep</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pst</strong> (<em>pyemu.Pst</em>) – </li>
<li><strong>num_steps</strong> (<em>int</em>) – number of pertubation steps for each parameter</li>
<li><strong>par_names</strong> (<em>list</em>) – names of pars to test.  If None, all adjustable pars are used
Default is None</li>
<li><strong>forward</strong> (<em>bool</em>) – flag to start with forward pertubations.  Default is True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>df</strong> – the index of the dataframe is par name and the parval used.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.helpers.write_df_tpl">
<code class="descclassname">pyemu.utils.helpers.</code><code class="descname">write_df_tpl</code><span class="sig-paren">(</span><em>filename</em>, <em>df</em>, <em>sep='</em>, <em>'</em>, <em>tpl_marker='~'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/helpers.html#write_df_tpl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.helpers.write_df_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>function write a pandas dataframe to a template file.
:param filename: template filename
:type filename: str
:param df: dataframe to write
:type df: pandas.DataFrame
:param sep: separate to pass to df.to_csv(). default is ‘,’
:type sep: char
:param tpl_marker: template file marker.  default is ‘~’
:type tpl_marker: char
:param kwargs: additional keyword args to pass to df.to_csv()
:type kwargs: dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you don’t use this function, make sure that you flush the
file handle before df.to_csv() and you pass mode=’a’ to to_csv()</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils.optimization">
<span id="pyemu-utils-optimization-module"></span><h2>pyemu.utils.optimization module<a class="headerlink" href="#module-pyemu.utils.optimization" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyemu.utils.optimization.add_pi_obj_func">
<code class="descclassname">pyemu.utils.optimization.</code><code class="descname">add_pi_obj_func</code><span class="sig-paren">(</span><em>pst</em>, <em>obj_func_dict=None</em>, <em>out_pst_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/optimization.html#add_pi_obj_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.optimization.add_pi_obj_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyemu.utils.pp_utils">
<span id="pyemu-utils-pp-utils-module"></span><h2>pyemu.utils.pp_utils module<a class="headerlink" href="#module-pyemu.utils.pp_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyemu.utils.pp_utils.setup_pilotpoints_grid">
<code class="descclassname">pyemu.utils.pp_utils.</code><code class="descname">setup_pilotpoints_grid</code><span class="sig-paren">(</span><em>ml=None</em>, <em>sr=None</em>, <em>ibound=None</em>, <em>prefix_dict=None</em>, <em>every_n_cell=4</em>, <em>use_ibound_zones=False</em>, <em>pp_dir='.'</em>, <em>tpl_dir='.'</em>, <em>shapename='pp.shp'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/pp_utils.html#setup_pilotpoints_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.pp_utils.setup_pilotpoints_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>setup grid-based pilot points.  Uses the ibound to determine
where to set pilot points. pilot points are given generic <code class="docutils literal notranslate"><span class="pre">pp_</span></code>
names unless <code class="docutils literal notranslate"><span class="pre">prefix_dict</span></code> is passed.  Write template files and a
shapefile as well…hopefully this is useful to someone…</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ml</strong> (<em>flopy.mbase</em>) – a flopy mbase dervied type.  If None, sr must not be None.</li>
<li><strong>sr</strong> (<em>flopy.utils.reference.SpatialReference</em>) – a spatial reference use to locate the model grid in space.  If None,
ml must not be None.  Default is None</li>
<li><strong>ibound</strong> (<em>numpy.ndarray</em>) – the modflow ibound integer array.  Used to set pilot points only in active areas (!=0).
If None and ml is None, then pilot points are set in all rows and columns according to
every_n_cell.  Default is None.</li>
<li><strong>prefix_dict</strong> (<em>dict</em>) – a dictionary of layer index, pilot point parameter prefixes.
Example : <code class="docutils literal notranslate"><span class="pre">{0:[&quot;hk_&quot;],1:[&quot;vka_&quot;]}</span></code> would setup pilot points with
the prefix <code class="docutils literal notranslate"><span class="pre">&quot;hk&quot;</span></code> for model layers 1 and <code class="docutils literal notranslate"><span class="pre">&quot;vka&quot;</span></code> for model layer 2 (zero based).
If None, a generic set of pilot points with the “pp” prefix are setup
for a generic nrowXncol grid. Default is None.</li>
<li><strong>use_ibound_zones</strong> (<em>bool</em>) – a flag to use the greater-than-zero values in the ibound as pilot point zones.  If False,ibound
values greater than zero are treated as a single zone.  Default is False.</li>
<li><strong>pp_dir</strong> (<em>str</em>) – directory to write pilot point files to.  Default is ‘.’</li>
<li><strong>tpl_dir</strong> (<em>str</em>) – directory to write pilot point template file to.  Default is ‘.’</li>
<li><strong>shapename</strong> (<em>str</em>) – name of shapefile to write that contains pilot point information. Default is “pp.shp”</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pp_df</strong> – a dataframe summarizing pilot point information (same information
written to shapename</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;import</span> <span class="pre">flopy</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;from</span> <span class="pre">pyemu.utils</span> <span class="pre">import</span> <span class="pre">setup_pilotpoints_grid</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;m</span> <span class="pre">=</span> <span class="pre">flopy.modflow.Modfow.load(&quot;mymodel.nam&quot;)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;setup_pilotpoints_grid(m,prefix_dict={0:['hk_'],1:['vka_']},</span></code></p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">every_n_cell=3,shapename='layer1_pp.shp')</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.pp_utils.pp_file_to_dataframe">
<code class="descclassname">pyemu.utils.pp_utils.</code><code class="descname">pp_file_to_dataframe</code><span class="sig-paren">(</span><em>pp_filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/pp_utils.html#pp_file_to_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.pp_utils.pp_file_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>read a pilot point file to a pandas Dataframe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pp_filename</strong> (<em>str</em>) – pilot point file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>df</strong> – a dataframe with pp_utils.PP_NAMES for columns</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.pp_utils.pp_tpl_to_dataframe">
<code class="descclassname">pyemu.utils.pp_utils.</code><code class="descname">pp_tpl_to_dataframe</code><span class="sig-paren">(</span><em>tpl_filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/pp_utils.html#pp_tpl_to_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.pp_utils.pp_tpl_to_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>read a pilot points template file to a pandas dataframe</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tpl_filename</strong> (<em>str</em>) – pilot points template file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>df</strong> – a dataframe with “parnme” included</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">pandas.DataFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.pp_utils.write_pp_shapfile">
<code class="descclassname">pyemu.utils.pp_utils.</code><code class="descname">write_pp_shapfile</code><span class="sig-paren">(</span><em>pp_df</em>, <em>shapename=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/pp_utils.html#write_pp_shapfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.pp_utils.write_pp_shapfile" title="Permalink to this definition">¶</a></dt>
<dd><p>write pilot points dataframe to a shapefile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pp_df</strong> (<em>pandas.DataFrame</em><em> or </em><em>str</em>) – pilot point dataframe or a pilot point filename.  Dataframe
must include “x” and “y”</li>
<li><strong>shapename</strong> (<em>str</em>) – shapefile name.  If None, pp_df must be str and shapefile
is saved as &lt;pp_df&gt;.shp</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">requires pyshp</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.pp_utils.write_pp_file">
<code class="descclassname">pyemu.utils.pp_utils.</code><code class="descname">write_pp_file</code><span class="sig-paren">(</span><em>filename</em>, <em>pp_df</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/pp_utils.html#write_pp_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.pp_utils.write_pp_file" title="Permalink to this definition">¶</a></dt>
<dd><p>write a pilot points dataframe to a pilot points file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>str</em>) – pilot points file to write</li>
<li><strong>pp_df</strong> (<em>pandas.DataFrame</em>) – a dataframe that has columns “x”,”y”,”zone”, and “value”</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyemu.utils.pp_utils.pilot_points_to_tpl">
<code class="descclassname">pyemu.utils.pp_utils.</code><code class="descname">pilot_points_to_tpl</code><span class="sig-paren">(</span><em>pp_file</em>, <em>tpl_file=None</em>, <em>name_prefix=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyemu/utils/pp_utils.html#pilot_points_to_tpl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyemu.utils.pp_utils.pilot_points_to_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>write a template file for a pilot points file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pp_file</strong> (<em>str</em>) – pilot points file</li>
<li><strong>tpl_file</strong> (<em>str</em>) – template file name to write.  If None, append “.tpl” to
the pp_file arg. Default is None</li>
<li><strong>name_prefix</strong> (<em>str</em>) – name to prepend to parameter names for each pilot point.  For example,
if <code class="docutils literal notranslate"><span class="pre">name_prefix</span> <span class="pre">=</span> <span class="pre">&quot;hk_&quot;</span></code>, then each pilot point parameter will be named
“hk_0001”,”hk_0002”, etc.  If None, parameter names from pp_df.name
are used.  Default is None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p><strong>pp_df</strong> –</p>
<dl class="docutils">
<dt>a dataframe with pilot point information (name,x,y,zone,parval1)</dt>
<dd><p class="first last">with the parameter information (parnme,tpl_str)</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pyemu.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyemu.utils" title="Permalink to this headline">¶</a></h2>
<p>pyemu utils module contains lots of useful functions and
classes, including support for geostatistical interpolation and
covariance matrices, pilot point setup and processing and
functionality dedicated to wrapping MODFLOW models into
the PEST(++) model independent framework</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pyemu.utils package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.geostats">pyemu.utils.geostats module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.gw_utils">pyemu.utils.gw_utils module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.helpers">pyemu.utils.helpers module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.optimization">pyemu.utils.optimization module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils.pp_utils">pyemu.utils.pp_utils module</a></li>
<li><a class="reference internal" href="#module-pyemu.utils">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/source/pyemu.utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jeremy White, Mike Fienen, John Doherty.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../_sources/source/pyemu.utils.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>